{"version":3,"sources":["webpack://blog/./node_modules/@datadog/browser-rum-core/esm/rawRumEvent.types.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/lifeCycle.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/browser/domMutationCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/resource/resourceUtils.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/tracing/getDocumentTraceId.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/browser/performanceCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/assembly.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/parentContexts.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/tracing/tracer.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/requestCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/trackEventCounts.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/trackPageActivities.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/action/getActionNameFromElement.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/action/trackActions.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/action/actionCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackFirstHidden.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/error/errorCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/resource/matchRequestTiming.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/resource/resourceCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackTimings.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/trackViews.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/view/viewCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumSession.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/transport/batch.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/boot/buildEnv.js","webpack://blog/./node_modules/@datadog/browser-rum/esm/boot/rum.entry.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/boot/rumPublicApi.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/boot/rum.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/rumEventsCollection/longTask/longTaskCollection.js","webpack://blog/./node_modules/@datadog/browser-rum-core/esm/domain/internalContext.js"],"names":["RumEventType","ViewLoadingType","ActionType","LifeCycleEventType","LifeCycle","this","callbacks","prototype","notify","eventType","data","eventCallbacks","forEach","callback","subscribe","_this","push","unsubscribe","filter","other","startDOMMutationCollection","lifeCycle","observer","MutationObserver","constructor","browserWindow","window","Zone","symbol","__symbol__","getMutationObserverConstructor","DOM_MUTATED","observe","document","documentElement","attributes","characterData","childList","subtree","stop","disconnect","FAKE_INITIAL_DOCUMENT","RESOURCE_TYPES","initiatorType","_","path","test","exec","areInOrder","numbers","_i","arguments","length","i","computePerformanceResourceDetails","entry","validEntry","toValidEntry","startTime","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","details","download","formatTiming","responseEnd","first_byte","connect","ssl","dns","hasRedirection","redirect","origin","start","end","duration","computeSize","decodedBodySize","isAllowedRequestUrl","configuration","url","isIntakeUrl","INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD","getDocumentTraceId","traceIdMeta","querySelector","traceTimeMeta","createDocumentTraceData","content","getDocumentTraceDataFromMeta","comment","childNodes","getTraceCommentFromNode","body","node","isTextNode","findTraceComment","getDocumentTraceDataFromComment","traceTime","Date","now","traceId","rawTraceTime","Number","nodeName","isCommentNode","match","supportPerformanceObject","undefined","performance","supportPerformanceTimingEvent","entryType","PerformanceObserver","supportedEntryTypes","includes","startPerformanceCollection","timing","handleRumPerformanceEntry","forcedAttributes","getEntriesByType","navigationEntry","toJSON","relativePerformanceTiming","computeRelativePerformanceTiming","name","location","href","handlePerformanceEntries","getEntries","entries","entryTypes","addEventListener","clearResourceTimings","sendFakeTiming","setTimeout","retrieveNavigationTiming","startTimeStamp","timingSent","removeEventListeners","evt","cancelable","processingStart","timeStamp","type","sendTimingIfPointerIsNotCancelled","sendTiming","passive","capture","event","once","delay","retrieveFirstInputTiming","result","key","numberKey","timingElement","loadEventEnd","isIncompleteNavigation","isForbiddenResource","PERFORMANCE_ENTRY_COLLECTED","SessionType","FIELDS_WITH_SENSITIVE_DATA","startRumAssembly","applicationId","session","parentContexts","getCommonContext","RAW_RUM_EVENT_COLLECTED","_a","rawRumEvent","savedCommonContext","customerContext","viewContext","findView","isTracked","id","actionContext","findAction","commonContext","rumContext","_dd","format_version","application","date","service","has_replay","hasReplay","_DATADOG_SYNTHETICS_BROWSER","USER","SYNTHETICS","serverRumEvent","ERROR","RESOURCE","LONG_TASK","indexOf","context","user","usr","beforeSend","limitModification","VIEW","console","warn","shouldSend","RUM_EVENT_COLLECTED","VIEW_CONTEXT_TIME_OUT_DELAY","ACTION_CONTEXT_TIME_OUT_DELAY","CLEAR_OLD_CONTEXTS_INTERVAL","startParentContexts","currentView","currentAction","currentSessionId","previousViews","previousActions","VIEW_CREATED","currentContext","unshift","buildCurrentViewContext","endTime","getId","VIEW_UPDATED","AUTO_ACTION_CREATED","AUTO_ACTION_COMPLETED","action","buildCurrentActionContext","AUTO_ACTION_DISCARDED","SESSION_RENEWED","clearOldContextsInterval","setInterval","clearOldContexts","previousContexts","timeOutDelay","oldTimeThreshold","pop","view","referrer","findContext","buildContext","previousContexts_1","previousContext","clearInterval","clearTracingIfCancelled","status","spanId","injectHeadersIfTracingAllowed","inject","getCrypto","requestUrl","requestOrigin","allowedTracingOrigins","allowedOrigin","RegExp","isAllowedUrl","TraceIdentifier","toDecimalString","crypto","msCrypto","buffer","Uint8Array","getRandomValues","toString","radix","high","readInt32","low","str","mod","Math","floor","offset","nextRequestIndex","startRequestCollection","tracer","traceFetch","tracingHeaders","input","Request","init","headers","Object","keys","append","headers_1","Headers","value","Array","isArray","header","concat","traceXhr","xhr","setRequestHeader","startTracer","xhrProxy","requestIndex","getNextRequestIndex","REQUEST_STARTED","onRequestComplete","REQUEST_COMPLETED","method","response","trackXhr","fetchProxy","responseType","trackFetch","trackEventCounts","eventCounts","errorCount","longTaskCount","resourceCount","userActionCount","subscription","ACTION","waitIdlePageActivity","completionCallback","firstRequestIndex","observable","subscriptions","pendingRequestsCount","notifyPageActivity","isBusy","startEvent","request","s","trackPageActivities","pageActivitiesObservable","stopPageActivitiesTracking","stopWaitPageActivitiesCompletion","idleTimeoutId","hasCompleted","validationTimeoutId","complete","maxDurationTimeoutId","clearTimeout","lastChangeTime","hadActivity","waitPageActivitiesCompletion","getActionNameFromElement","element","targetElement","elementWithAttribute","supportsElementClosestResult","HTMLElement","supportsElementClosest","closest","hasAttribute","PROGRAMMATIC_ATTRIBUTE","parentElement","truncate","normalizeWhitespace","getAttribute","trim","getActionNameFromElementProgrammatically","getActionNameFromElementForStrategies","priorityStrategies","fallbackStrategies","supportsInnerTextScriptAndStyleRemovalResult","supportsLabelPropertyResult","HTMLInputElement","supportsLabelProperty","labels","getTextualContent","label","ownerDocument","replace","labelledByAttribute","split","map","refElement","getElementById","Boolean","join","options","strategies","recursionCounter","strategies_1","name_1","strategy","trimmedName","isContentEditable","text","innerText","style","createElement","textContent","div","appendChild","removeChild","supportsInnerTextScriptAndStyleRemoval","elementsTextToRemove","querySelectorAll","trackActions","currentIdlePageActivitySubscription","create","pendingAutoAction","PendingAutoAction","discard","discardCurrent","startActionManagement","stopListener","target","Element","CLICK","eventCountsSubscription","counts","startActionCollection","processAction","trackInteractions","addAction","autoActionProperties","isAutoAction","error","count","loading_time","long_task","resource","CUSTOM","trackFirstHiddenSingleton","startErrorCollection","processError","addError","rawError","source","stackTrace","Error","computeStackTrace","computeRawError","doStartErrorCollection","message","status_code","statusCode","stack","matchRequestTiming","sameNameEntries","getEntriesByName","correspondingEntries","candidates","startResourceCollection","isTrackedWithResource","matchingTiming","correspondingTimingOverrides","computePerformanceEntryMetrics","tracingInfo","span_id","trace_id","computeRequestTracingInfo","resourceEvent","processRequest","RESOURCE_TYPES_1","isType","computeResourceKind","entryMetrics","computeEntryTracingInfo","processResourceEntry","size","trackFirstHidden","emitter","visibilityState","Infinity","trackTimings","timings","setTimings","newTimings","stopNavigationTracking","domComplete","domContentLoaded","domContentLoadedEventEnd","domInteractive","loadEvent","trackNavigationTimings","stopFCPTracking","firstHidden","trackFirstContentfulPaint","firstContentfulPaint","stopLCPTracking","firstInteractionTimestamp","stopEventListener","unsubscribeLifeCycle","trackLargestContentfulPaint","largestContentfulPaint","stopFIDTracking","firstInputDelay","firstInputTime","fid","trackFirstInputTimings","SESSION_KEEP_ALIVE_INTERVAL","trackViews","onNewLocation","onHashChange","initialView","newView","INITIAL_LOAD","viewName","stopTimingsTracking","updateTimings","scheduleUpdate","stopHistoryTracking","onHistoryChange","originalPushState","history","pushState","apply","originalReplaceState","replaceState","removeListener","trackHistory","onLocationChange","stopHashTracking","getLocation","shouldCreateView","isDifferentView","triggerUpdate","ROUTE_CHANGE","updateLocation","BEFORE_UNLOAD","keepAliveInterval","addTiming","time","initialLocation","loadingType","cumulativeLayoutShift","loadingTime","customTimings","documentVersion","stopCLSTracking","triggerViewUpdate","leading","scheduleViewUpdate","throttled","cancelScheduleViewUpdate","cancel","stopEventCountsTracking","newEventCounts","_b","loadType","isWaitingForLoadEvent","isWaitingForActivityLoadingTime","loadingTimeCandidates","invokeCallbackIfAllCandidatesAreReceived","max","setLoadEvent","setActivityLoadingTime","activityLoadingTime","trackLoadingTime","newLoadingTime","stopActivityLoadingTimeTracking","trackActivityLoadingTime","isActive","hadRecentInput","trackLayoutShift","layoutShift","VIEW_ENDED","otherLocation","pathname","hash","correspondingId","substr","sanitized","sanitizeTiming","newLocation","startViewCollection","viewEvent","document_version","cumulative_layout_shift","dom_complete","dom_content_loaded","dom_interactive","first_contentful_paint","first_input_delay","first_input_time","is_active","largest_contentful_paint","load_event","loading_type","time_spent","custom_timings","processViewUpdate","RumTrackingType","startRumSession","cookieOptions","rawTrackingType","trackingType","NOT_TRACKED","TRACKED_WITH_RESOURCES","TRACKED_WITHOUT_RESOURCES","hasValidRumSession","sampleRate","resourceSampleRate","_isTracked","computeSessionState","renewObservable","getTrackingType","rumSessionType","startRumBatch","batch","replicaBatch","primaryBatch","createRumBatch","rumEndpoint","replica","endpointUrl","unloadCallback","batchBytesLimit","maxBatchSize","maxMessageSize","flushTimeout","withReplicaApplicationId","stopped","add","upsert","makeRumBatch","buildEnv","buildMode","datacenter","sdkVersion","datadogRum","startRumImpl","isAlreadyInitialized","globalContextManager","getInternalContextStrategy","beforeInitAddTiming","addTimingStrategy","beforeInitAddAction","addActionStrategy","clonedCommonContext","beforeInitAddError","addErrorStrategy","providedError","get","rumGlobal","userConfiguration","silentMultipleInit","clientToken","publicApiKey","canInitRum","getInternalContext","drain","addRumGlobalContext","removeRumGlobalContext","remove","getRumGlobalContext","setRumGlobalContext","set","addUserAction","checkedSource","setUser","newUser","sanitizedUser","String","email","sanitizeUser","makeRumPublicApi","internalMonitoring","isEnabled","setExternalContextProvider","application_id","startLongTaskCollection","catchUserErrors","stopViewCollection","startRumEventCollection","internalContext","session_id","user_action","startInternalContext"],"mappings":"sJAAWA,EAUAC,EAOAC,E,oGAfX,SAAWF,GACTA,EAAqB,OAAI,SACzBA,EAAoB,MAAI,QACxBA,EAAwB,UAAI,YAC5BA,EAAmB,KAAI,OACvBA,EAAuB,SAAI,WAL7B,CAMGA,IAAiBA,EAAe,KAInC,SAAWC,GACTA,EAA8B,aAAI,eAClCA,EAA8B,aAAI,eAFpC,CAGGA,IAAoBA,EAAkB,KAIzC,SAAWC,GACTA,EAAkB,MAAI,QACtBA,EAAmB,OAAI,SAFzB,CAGGA,IAAeA,EAAa,K,ICtBpBC,E,YAEX,SAAWA,GACTA,EAAmBA,EAAgD,4BAAI,GAAK,8BAC5EA,EAAmBA,EAAwC,oBAAI,GAAK,sBACpEA,EAAmBA,EAA0C,sBAAI,GAAK,wBACtEA,EAAmBA,EAA0C,sBAAI,GAAK,wBACtEA,EAAmBA,EAAiC,aAAI,GAAK,eAC7DA,EAAmBA,EAAiC,aAAI,GAAK,eAC7DA,EAAmBA,EAA+B,WAAI,GAAK,aAC3DA,EAAmBA,EAAoC,gBAAI,GAAK,kBAChEA,EAAmBA,EAAsC,kBAAI,GAAK,oBAClEA,EAAmBA,EAAoC,gBAAI,GAAK,kBAChEA,EAAmBA,EAAgC,YAAI,IAAM,cAC7DA,EAAmBA,EAAkC,cAAI,IAAM,gBAC/DA,EAAmBA,EAA4C,wBAAI,IAAM,0BACzEA,EAAmBA,EAAwC,oBAAI,IAAM,sBAdvE,CAeGA,IAAuBA,EAAqB,KAE/C,IAAIC,EAEJ,WACE,SAASA,IACPC,KAAKC,UAAY,GA8BnB,OA3BAF,EAAUG,UAAUC,OAAS,SAAUC,EAAWC,GAChD,IAAIC,EAAiBN,KAAKC,UAAUG,GAEhCE,GACFA,EAAeC,SAAQ,SAAUC,GAC/B,OAAOA,EAASH,OAKtBN,EAAUG,UAAUO,UAAY,SAAUL,EAAWI,GACnD,IAAIE,EAAQV,KAOZ,OALKA,KAAKC,UAAUG,KAClBJ,KAAKC,UAAUG,GAAa,IAG9BJ,KAAKC,UAAUG,GAAWO,KAAKH,GACxB,CACLI,YAAa,WACXF,EAAMT,UAAUG,GAAaM,EAAMT,UAAUG,GAAWS,QAAO,SAAUC,GACvE,OAAON,IAAaM,QAMrBf,EAhCT,GCUO,SAASgB,EAA2BC,GACzC,IAAIC,EACAC,EA9BN,WACE,IAAIC,EACAC,EAAgBC,OAYpB,GAAID,EAAcE,KAAM,CAEtB,IAAIC,EAASH,EAAcE,KAAKE,WAAW,oBAE3CL,EAAcC,EAAcG,GAO9B,OAJKJ,IACHA,EAAcC,EAAcF,kBAGvBC,EAKgBM,GAcvB,OAZIP,IACFD,EAAW,IAAIC,GAAiB,SAAQ,WACtCF,EAAUb,OAAOL,EAAmB4B,kBAE7BC,QAAQC,SAASC,gBAAiB,CACzCC,YAAY,EACZC,eAAe,EACfC,WAAW,EACXC,SAAS,IAIN,CACLC,KAAM,WACAjB,GACFA,EAASkB,e,0BChDNC,EAAwB,mBAC/BC,EAAiB,CAAC,CAAC,cAAuB,SAAUC,GACtD,OAAOF,IAA0BE,IAC/B,CAAC,SAAkB,SAAUA,GAC/B,MAAO,mBAAqBA,IAC1B,CAAC,WAAoB,SAAUA,GACjC,MAAO,UAAYA,IACjB,CAAC,YAAqB,SAAUA,GAClC,MAAO,WAAaA,IAClB,CAAC,SAAkB,SAAUC,EAAGC,GAClC,MAAO,UAAUC,KAAKD,KACpB,CAAC,QAAiB,SAAUD,EAAGC,GACjC,MAAO,SAASC,KAAKD,KACnB,CAAC,WAAoB,SAAUF,EAAeE,GAChD,OAAO,QAAS,CAAC,QAAS,MAAO,QAASF,IAAuE,OAArD,sCAAsCI,KAAKF,KACrG,CAAC,UAAmB,SAAUD,EAAGC,GACnC,OAAiD,OAA1C,2BAA2BE,KAAKF,KACrC,CAAC,WAAoB,SAAUF,EAAeE,GAChD,OAAO,QAAS,CAAC,QAAS,SAAUF,IAAiD,OAA/B,gBAAgBI,KAAKF,MAyB7E,SAASG,IAGP,IAFA,IAAIC,EAAU,GAELC,EAAK,EAAGA,EAAKC,UAAUC,OAAQF,IACtCD,EAAQC,GAAMC,UAAUD,GAG1B,IAAK,IAAIG,EAAI,EAAGA,EAAIJ,EAAQG,OAAQC,GAAK,EACvC,GAAIJ,EAAQI,EAAI,GAAKJ,EAAQI,GAC3B,OAAO,EAIX,OAAO,EAiBF,SAASC,EAAkCC,GAChD,IAAIC,EAAaC,EAAaF,GAE9B,GAAKC,EAAL,CAIA,IAAIE,EAAYF,EAAWE,UACvBC,EAAaH,EAAWG,WACxBC,EAAgBJ,EAAWI,cAC3BC,EAAcL,EAAWK,YACzBC,EAAoBN,EAAWM,kBAC/BC,EAAkBP,EAAWO,gBAC7BC,EAAeR,EAAWQ,aAC1BC,EAAwBT,EAAWS,sBACnCC,EAAaV,EAAWU,WACxBC,EAAeX,EAAWW,aAC1BC,EAAgBZ,EAAWY,cAE3BC,EAAU,CACZC,SAAUC,EAAab,EAAWU,EAFlBZ,EAAWgB,aAG3BC,WAAYF,EAAab,EAAWS,EAAcC,IAoBpD,OAjBIF,IAAeP,IACjBU,EAAQK,QAAUH,EAAab,EAAWM,EAAcE,GAEpDlB,EAAWgB,EAAcC,EAAuBC,KAClDG,EAAQM,IAAMJ,EAAab,EAAWO,EAAuBC,KAK7DH,IAAoBJ,IACtBU,EAAQO,IAAML,EAAab,EAAWI,EAAmBC,IAGvDc,EAAetB,KACjBc,EAAQS,SAAWP,EAAab,EAAWE,EAAeC,IAGrDQ,GAEF,SAASZ,EAAaF,GAK3B,GAAKP,EAAWO,EAAMG,UAAWH,EAAMI,WAAYJ,EAAMO,kBAAmBP,EAAMQ,gBAAiBR,EAAMS,aAAcT,EAAMW,WAAYX,EAAMY,aAAcZ,EAAMa,cAAeb,EAAMiB,aAAxL,CAIA,IAAKK,EAAetB,GAClB,OAAOA,EAGT,IAAIK,EAAgBL,EAAMK,cACtBC,EAAcN,EAAMM,YAYxB,GATID,EAAgBL,EAAMG,YACxBE,EAAgBL,EAAMG,WAGpBG,EAAcN,EAAMG,YACtBG,EAAcN,EAAMI,YAIjBX,EAAWO,EAAMG,UAAWE,EAAeC,EAAaN,EAAMI,YAInE,OAAO,SAAS,QAAS,GAAIJ,GAAQ,CACnCM,YAAaA,EACbD,cAAeA,KAInB,SAASiB,EAAetB,GAEtB,OAAOA,EAAMI,aAAeJ,EAAMG,UAGpC,SAASa,EAAaQ,EAAQC,EAAOC,GACnC,MAAO,CACLC,UAAU,SAAiB,QAAQF,EAAOC,IAC1CD,OAAO,SAAiB,QAAQD,EAAQC,KAIrC,SAASG,EAAY5B,GAE1B,GAAIA,EAAMG,UAAYH,EAAMa,cAC1B,OAAOb,EAAM6B,gBAKV,SAASC,EAAoBC,EAAeC,GACjD,OAAOA,IAAQD,EAAcE,YAAYD,GC9KpC,IAAIE,EAA+C,EAAI,KACvD,SAASC,EAAmBzD,GACjC,IAAIvB,EAQC,SAAsCuB,GAC3C,IAAI0D,EAAc1D,EAAS2D,cAAc,0BACrCC,EAAgB5D,EAAS2D,cAAc,4BAC3C,OAAOE,EAAwBH,GAAeA,EAAYI,QAASF,GAAiBA,EAAcE,SAXvFC,CAA6B/D,IAanC,SAAyCA,GAC9C,IAAIgE,EAoBC,SAA0BhE,GAK/B,IAAK,IAAIoB,EAAI,EAAGA,EAAIpB,EAASiE,WAAW9C,OAAQC,GAAK,EAAG,CAGtD,GAFI4C,EAAUE,EAAwBlE,EAASiE,WAAW7C,IAGxD,OAAO4C,EAQX,GAAIhE,EAASmE,KACX,IAAS/C,EAAIpB,EAASmE,KAAKF,WAAW9C,OAAS,EAAGC,GAAK,EAAGA,GAAK,EAAG,CAChE,IACI4C,EADAI,EAAOpE,EAASmE,KAAKF,WAAW7C,GAGpC,GAFI4C,EAAUE,EAAwBE,GAGpC,OAAOJ,EAGT,IAAKK,EAAWD,GACd,OA/CQE,CAAiBtE,GAE/B,IAAKgE,EACH,OAGF,OAAOH,GAAwB,QAAwBG,EAAS,aAAa,QAAwBA,EAAS,eApBzDO,CAAgCvE,GAErF,GAAKvB,KAAQA,EAAK+F,WAAaC,KAAKC,MAAQlB,GAI5C,OAAO/E,EAAKkG,QAgBP,SAASd,EAAwBc,EAASC,GAC/C,IAAIJ,EAAYI,GAAgBC,OAAOD,GAEvC,GAAKD,GAAYH,EAIjB,MAAO,CACLG,QAASA,EACTH,UAAWA,GAoCf,SAASN,EAAwBE,GAC/B,GAAIA,GASN,SAAuBA,GACrB,MAAyB,aAAlBA,EAAKU,SAVAC,CAAcX,GAAO,CAC/B,IAAIY,EAAQ,wBAAwBlE,KAAKsD,EAAK3F,MAE9C,GAAIuG,EACF,OAAOA,EAAM,IASnB,SAASX,EAAWD,GAClB,MAAyB,UAAlBA,EAAKU,SC/Ed,SAASG,IACP,YAA8BC,IAAvBzF,OAAO0F,aAA6B,eAAgBA,YAGtD,SAASC,EAA8BC,GAC5C,OAAO5F,OAAO6F,0BAAmEJ,IAA5CI,oBAAoBC,qBAAqCD,oBAAoBC,oBAAoBC,SAASH,GAE1I,SAASI,EAA2BrG,EAAWiE,GAsC/C,IAA+CzE,EA7BpD,GA6BoDA,EArCd,SAAU8G,GAC9CC,EAA0BvG,EAAWiE,EAAeqC,KAqCtD,QAAgB,eAAe,WAC7B,IAAIA,EACAE,EAAmB,CACrBP,UAAW,WACX3E,cAAeF,EACfmE,QAASlB,EAAmBzD,WAG9B,GAAIoF,EAA8B,eAAiBD,YAAYU,iBAAiB,cAAc1E,OAAS,EAAG,CACxG,IAAI2E,EAAkBX,YAAYU,iBAAiB,cAAc,GACjEH,GAAS,SAAS,QAAS,GAAII,EAAgBC,UAAWH,OACrD,CACL,IAAII,EAA4BC,IAChCP,GAAS,SAAS,SAAS,QAAS,GAAIM,GAA4B,CAClE7C,gBAAiB,EACjBF,SAAU+C,EAA0BzD,YACpC2D,KAAMzG,OAAO0G,SAASC,KACtB3E,UAAW,IACTmE,GAGNhH,EAAS8G,MAvDPT,KACFoB,EAAyBjH,EAAWiE,EAAe8B,YAAYmB,cAG7D7G,OAAO6F,oBAAqB,CACf,IAAIA,qBAAoB,SAAQ,SAAUiB,GACvD,OAAOF,EAAyBjH,EAAWiE,EAAekD,EAAQD,kBAG3DvG,QAAQ,CACfyG,WAFe,CAAC,WAAY,aAAc,WAAY,QAAS,2BAA4B,cAAe,kBAKxGvB,KAA8B,qBAAsBE,aAEtDA,YAAYsB,iBAAiB,4BAA4B,WACvDtB,YAAYuB,0BAKbtB,EAA8B,eAsCrC,SAAkCxG,GAChC,SAAS+H,IACP/H,GAAS,SAAS,QAAS,GAAIqH,KAAqC,CAClEZ,UAAW,iBAIf,QAAgB,YAAY,WAE1BuB,YAAW,QAAQD,OA9CnBE,EAAyB,SAAUnB,GACjCC,EAA0BvG,EAAWiE,EAAeqC,MAInDN,EAA8B,gBAkDrC,SAAkCxG,GAChC,IAAIkI,EAAiBrC,KAAKC,MACtBqC,GAAa,EACbC,GAAuB,QAAkBvH,OAAQ,CAAC,QAEpD,YAEA,UAEA,aAEA,gBAEC,SAAUwH,GAEX,GAAKA,EAAIC,WAAT,CAOA,IAAIxB,EAAS,CACXL,UAAW,cACX8B,iBAAiB,UACjB1F,UAAWwF,EAAIG,UACflB,KAAM,YAAce,EAAII,MAGT,gBAAbJ,EAAII,KAGJC,EAAkC5B,GAEpC6B,EAAW7B,MAEZ,CACD8B,SAAS,EACTC,SAAS,IACRnH,KAQH,SAASgH,EAAkC5B,IACzC,QAAkBjG,OAAQ,CAAC,YAEzB,kBAEC,SAAUiI,GACQ,cAAfA,EAAML,MAGNE,EAAW7B,KAEd,CACDiC,MAAM,IAIV,SAASJ,EAAW7B,GAClB,IAAKqB,EAAY,CACfA,GAAa,EACbC,IAMA,IAAIY,EAAQlC,EAAOyB,gBAAkBzB,EAAOjE,UAExCmG,GAAS,GAAKA,EAAQnD,KAAKC,MAAQoC,GACrClI,EAAS8G,KA5HbmC,EAAyB,SAAUnC,GACjCC,EAA0BvG,EAAWiE,EAAeqC,MAiI1D,SAASO,IACP,IAAI6B,EAAS,GACTpC,EAASP,YAAYO,OAEzB,IAAK,IAAIqC,KAAOrC,EACd,IAAI,QAASA,EAAOqC,IAAO,CACzB,IAAIC,EAAYD,EAEZE,EAAgBvC,EAAOsC,GAC3BF,EAAOE,GAA+B,IAAlBC,EAAsB,GAAI,QAAgBA,GAIlE,OAAOH,EAGT,SAASzB,EAAyBjH,EAAWiE,EAAekD,GAC1DA,EAAQ5H,SAAQ,SAAU2C,GACA,aAApBA,EAAM+D,WAAgD,eAApB/D,EAAM+D,WAAkD,UAApB/D,EAAM+D,WAA6C,aAApB/D,EAAM+D,WAAgD,6BAApB/D,EAAM+D,WAAgE,gBAApB/D,EAAM+D,WAAmD,iBAApB/D,EAAM+D,WACtOM,EAA0BvG,EAAWiE,EAAe/B,MAK1D,SAASqE,EAA0BvG,EAAWiE,EAAe/B,IAQ7D,SAAgCA,GAC9B,MAA2B,eAApBA,EAAM+D,WAA8B/D,EAAM4G,cAAgB,GAR7DC,CAAuB7G,IAW7B,SAA6B+B,EAAe/B,GAC1C,MAA2B,aAApBA,EAAM+D,YAA6BjC,EAAoBC,EAAe/B,EAAM4E,MAZ9CkC,CAAoB/E,EAAe/B,IAIxElC,EAAUb,OAAOL,EAAmBmK,4BAA6B/G,G,IC1M/DgH,E,YAEJ,SAAWA,GACTA,EAAwB,WAAI,aAC5BA,EAAkB,KAAI,OAFxB,CAGGA,IAAgBA,EAAc,KAEjC,IAAIC,EAA6B,CAAC,WAAY,gBAAiB,qBAAsB,gBAAiB,cAAe,qBAAsB,gBACpI,SAASC,EAAiBC,EAAepF,EAAejE,EAAWsJ,EAASC,EAAgBC,GACjGxJ,EAAUP,UAAUX,EAAmB2K,yBAAyB,SAAUC,GACxE,IA6D8BpB,EA7D1BjG,EAAYqH,EAAGrH,UACfsH,EAAcD,EAAGC,YACjBC,EAAqBF,EAAGE,mBACxBC,EAAkBH,EAAGG,gBACrBC,EAAcP,EAAeQ,SAAS1H,GAE1C,GAAIiH,EAAQU,aAAeF,GAAeA,EAAYR,QAAQW,GAAI,CAChE,IAAIC,EAAgBX,EAAeY,WAAW9H,GAC1C+H,EAAgBR,GAAsBJ,IACtCa,EAAa,CACfC,IAAK,CACHC,eAAgB,GAElBC,YAAa,CACXP,GAAIZ,GAENoB,MAAM,UACNC,QAASzG,EAAcyG,QACvBpB,QAAS,CACPqB,WAAYP,EAAcQ,UAG1B3C,UA6CsCnC,IAAvCzF,OAAOwK,4BAA4C3B,EAAY4B,KAAO5B,EAAY6B,aA1CjFC,GAoCwB1C,EApCkBqB,GAqCkD,IAA7F,CAAChL,EAAasM,MAAOtM,EAAauM,SAAUvM,EAAawM,WAAWC,QAAQ9C,EAAML,OArCxB,QAAQoC,EAAYP,EAAaI,EAAeP,IAAe,QAAQU,EAAYP,EAAaH,IACzJ0B,GAAU,QAAQjB,EAAciB,QAASxB,IAExC,QAAcwB,KACjBL,EAAeK,QAAUA,IAGtB,QAAcjB,EAAckB,QAG/BN,EAAeO,IAAMnB,EAAckB,MAU3C,SAAoBhD,EAAOkD,GACzB,GAAIA,EAAY,CACd,IAAI9C,GAAS,EAAA+C,EAAA,GAAkBnD,EAAOa,EAA4BqC,GAElE,IAAe,IAAX9C,GAAoBJ,EAAML,OAAStJ,EAAa+M,KAClD,OAAO,GAGM,IAAXhD,GACFiD,QAAQC,KAAK,0EAIjB,OAAO,EApBCC,CAAWb,EAAgB/G,EAAcuH,aAC3CxL,EAAUb,OAAOL,EAAmBgN,oBAAqBd,O,eClDtDe,EAA8B,KAC9BC,EAAgC,EAAI,KAEpCC,EAA8B,KAClC,SAASC,EAAoBlM,EAAWsJ,GAC7C,IAAI6C,EACAC,EACAC,EACAC,EAAgB,GAChBC,EAAkB,GACtBvM,EAAUP,UAAUX,EAAmB0N,cAAc,SAAUC,GACzDN,GACFG,EAAcI,QAAQ,CACpBrB,QAASsB,IACTC,QAASH,EAAepK,UACxBA,UAAW8J,EAAY9J,YAI3B8J,EAAcM,EACdJ,EAAmB/C,EAAQuD,WAE7B7M,EAAUP,UAAUX,EAAmBgO,cAAc,SAAUL,GAGzDN,EAAYlC,KAAOwC,EAAexC,KACpCkC,EAAcM,MAGlBzM,EAAUP,UAAUX,EAAmBiO,qBAAqB,SAAUN,GACpEL,EAAgBK,KAElBzM,EAAUP,UAAUX,EAAmBkO,uBAAuB,SAAUC,GAClEb,GACFG,EAAgBG,QAAQ,CACtBrB,QAAS6B,IAETN,QAASR,EAAc/J,UAAY4K,EAAOpJ,SAC1CxB,UAAW+J,EAAc/J,YAI7B+J,OAAgBtG,KAElB9F,EAAUP,UAAUX,EAAmBqO,uBAAuB,WAC5Df,OAAgBtG,KAElB9F,EAAUP,UAAUX,EAAmBsO,iBAAiB,WACtDd,EAAgB,GAChBC,EAAkB,GAClBJ,OAAcrG,EACdsG,OAAgBtG,KAElB,IAAIuH,EAA2BC,aAAY,SAAQ,WACjDC,EAAiBjB,EAAeP,GAChCwB,EAAiBhB,EAAiBP,MAChCC,GAEJ,SAASsB,EAAiBC,EAAkBC,GAG1C,IAFA,IAAIC,EAAmB3H,YAAYT,MAAQmI,EAEpCD,EAAiBzL,OAAS,GAAKyL,EAAiBA,EAAiBzL,OAAS,GAAGM,UAAYqL,GAC9FF,EAAiBG,MAIrB,SAAShB,IACP,MAAO,CACLrD,QAAS,CACPW,GAAIoC,GAENuB,KAAM,CACJ3D,GAAIkC,EAAYlC,GAChBnD,KAAMqF,EAAYrF,KAClB+G,SAAU1B,EAAY0B,SACtB3J,IAAKiI,EAAYpF,SAASC,OAKhC,SAASkG,IACP,MAAO,CACLD,OAAQ,CACNhD,GAAImC,EAAcnC,KAKxB,SAAS6D,EAAYC,EAAcP,EAAkBf,EAAgBpK,GACnE,QAAkByD,IAAdzD,EACF,OAAOoK,EAAiBsB,SAAiBjI,EAG3C,GAAI2G,GAAkBpK,GAAaoK,EAAepK,UAChD,OAAO0L,IAGT,IAAK,IAAIlM,EAAK,EAAGmM,EAAqBR,EAAkB3L,EAAKmM,EAAmBjM,OAAQF,IAAM,CAC5F,IAAIoM,EAAkBD,EAAmBnM,GAEzC,GAAIQ,EAAY4L,EAAgBrB,QAC9B,MAGF,GAAIvK,GAAa4L,EAAgB5L,UAC/B,OAAO4L,EAAgB5C,SAO7B,MAAO,CACLlB,WAAY,SAAoB9H,GAC9B,OAAOyL,EAAYZ,EAA2BX,EAAiBH,EAAe/J,IAEhF0H,SAAU,SAAkB1H,GAC1B,OAAOyL,EAAYnB,EAAyBL,EAAeH,EAAa9J,IAE1EnB,KAAM,WACJgN,cAAcb,K,yBCxHb,SAASc,EAAwB9C,GACf,IAAnBA,EAAQ+C,SACV/C,EAAQ9F,aAAUO,EAClBuF,EAAQgD,YAASvI,GAgDrB,SAASwI,EAA8BrK,EAAeoH,EAASkD,GAgC/D,IAA4BhJ,OAPHO,IAAhB0I,MAfT,SAAsBvK,EAAewK,GAGnC,IAFA,IAAIC,GAAgB,QAAUD,GAErB5M,EAAK,EAAG6H,EAAKzF,EAAc0K,sBAAuB9M,EAAK6H,EAAG3H,OAAQF,IAAM,CAC/E,IAAI+M,EAAgBlF,EAAG7H,GAEvB,GAAI6M,IAAkBE,GAAiBA,aAAyBC,QAAUD,EAAcnN,KAAKiN,GAC3F,OAAO,EAIX,OAAO,EApBuBI,CAAa7K,EAAeoH,EAAQnH,OAIlEmH,EAAQ9F,QAAU,IAAIwJ,GACtB1D,EAAQgD,OAAS,IAAIU,GACrBR,GAyB0BhJ,EAzBA8F,EAAQ9F,QA0B3B,CACL,mBAAoB,MACpB,sBA5ByC8F,EAAQgD,OA4BnBW,kBAC9B,oBAAqB,IACrB,8BAA+B,IAC/B,qBAAsBzJ,EAAQyJ,sBAVlC,SAASR,KACP,OAAOnO,OAAO4O,QAAU5O,OAAO6O,SAejC,IAAIH,GAEJ,WACE,SAASA,IACP/P,KAAKmQ,OAAS,IAAIC,WAAW,GAC7BZ,KAAYa,gBAAgBrQ,KAAKmQ,QACjCnQ,KAAKmQ,OAAO,GAAsB,IAAjBnQ,KAAKmQ,OAAO,GAkC/B,OA/BAJ,EAAgB7P,UAAUoQ,SAAW,SAAUC,GAK7C,IAJA,IAAIC,EAAOxQ,KAAKyQ,UAAU,GACtBC,EAAM1Q,KAAKyQ,UAAU,GACrBE,EAAM,KAEA,CACR,IAAIC,EAAMJ,EAAOD,EAAQ,WAAaG,EAKtC,GAJAF,EAAOK,KAAKC,MAAMN,EAAOD,GACzBG,EAAMG,KAAKC,MAAMF,EAAML,GACvBI,GAAOC,EAAML,GAAOD,SAASC,GAASI,GAEjCH,IAASE,EACZ,MAIJ,OAAOC,GAOTZ,EAAgB7P,UAAU8P,gBAAkB,WAC1C,OAAOhQ,KAAKsQ,SAAS,KAGvBP,EAAgB7P,UAAUuQ,UAAY,SAAUM,GAC9C,OAA6B,SAAtB/Q,KAAKmQ,OAAOY,IAAsB/Q,KAAKmQ,OAAOY,EAAS,IAAM,KAAO/Q,KAAKmQ,OAAOY,EAAS,IAAM,GAAK/Q,KAAKmQ,OAAOY,EAAS,IAG3HhB,EAtCT,GC/FIiB,GAAmB,EAChB,SAASC,GAAuBjQ,EAAWiE,GAChD,IAAIiM,EDEC,SAAqBjM,GAC1B,MAAO,CACLkK,wBAAyBA,EACzBgC,WAAY,SAAoB9E,GAC9B,OAAOiD,EAA8BrK,EAAeoH,GAAS,SAAU+E,GACrE,IAAI1G,EAEJ,GAAI2B,EAAQgF,iBAAiBC,WAAqC,QAAvB5G,EAAK2B,EAAQkF,YAAyB,IAAP7G,OAAgB,EAASA,EAAG8G,SACpGnF,EAAQgF,MAAQ,IAAIC,QAAQjF,EAAQgF,OACpCI,OAAOC,KAAKN,GAAgB7Q,SAAQ,SAAUoJ,GAE5C0C,EAAQgF,MAAMG,QAAQG,OAAOhI,EAAKyH,EAAezH,WAE9C,CACL0C,EAAQkF,MAAO,QAAS,GAAIlF,EAAQkF,MACpC,IAAIK,EAAY,GAEZvF,EAAQkF,KAAKC,mBAAmBK,QAClCxF,EAAQkF,KAAKC,QAAQjR,SAAQ,SAAUuR,EAAOnI,GAC5CiI,EAAUjR,KAAK,CAACgJ,EAAKmI,OAEdC,MAAMC,QAAQ3F,EAAQkF,KAAKC,SACpCnF,EAAQkF,KAAKC,QAAQjR,SAAQ,SAAU0R,GACrCL,EAAUjR,KAAKsR,MAER5F,EAAQkF,KAAKC,SACtBC,OAAOC,KAAKrF,EAAQkF,KAAKC,SAASjR,SAAQ,SAAUoJ,GAClDiI,EAAUjR,KAAK,CAACgJ,EAAK0C,EAAQkF,KAAKC,QAAQ7H,QAI9C0C,EAAQkF,KAAKC,QAAUI,EAAUM,QAAO,QAAcd,SAI5De,SAAU,SAAkB9F,EAAS+F,GACnC,OAAO9C,EAA8BrK,EAAeoH,GAAS,SAAU+E,GACrEK,OAAOC,KAAKN,GAAgB7Q,SAAQ,SAAUuH,GAC5CsK,EAAIC,iBAAiBvK,EAAMsJ,EAAetJ,YCxCrCwK,CAAYrN,IAIpB,SAAkBjE,EAAWiE,EAAeiM,GACjD,IAAIqB,GAAW,SACfA,EAAS/F,YAAW,SAAUH,EAAS+F,GACjCpN,EAAoBC,EAAeoH,EAAQnH,OAC7CgM,EAAOiB,SAAS9F,EAAS+F,GACzB/F,EAAQmG,aAAeC,KACvBzR,EAAUb,OAAOL,EAAmB4S,gBAAiB,CACnDF,aAAcnG,EAAQmG,mBAI5BD,EAASI,mBAAkB,SAAUtG,GAC/BrH,EAAoBC,EAAeoH,EAAQnH,OAC7CgM,EAAO/B,wBAAwB9C,GAC/BrL,EAAUb,OAAOL,EAAmB8S,kBAAmB,CACrD/N,SAAUwH,EAAQxH,SAClBgO,OAAQxG,EAAQwG,OAChBL,aAAcnG,EAAQmG,aACtBM,SAAUzG,EAAQyG,SAClBzD,OAAQhD,EAAQgD,OAChBhM,UAAWgJ,EAAQhJ,UACnB+L,OAAQ/C,EAAQ+C,OAChB7I,QAAS8F,EAAQ9F,QACjB0C,KAAM,SACN/D,IAAKmH,EAAQnH,UA3BnB6N,CAAS/R,EAAWiE,EAAeiM,GAiC9B,SAAoBlQ,EAAWiE,EAAeiM,GACnD,IAAI8B,GAAa,SACjBA,EAAWxG,YAAW,SAAUH,GAC1BrH,EAAoBC,EAAeoH,EAAQnH,OAC7CgM,EAAOC,WAAW9E,GAClBA,EAAQmG,aAAeC,KACvBzR,EAAUb,OAAOL,EAAmB4S,gBAAiB,CACnDF,aAAcnG,EAAQmG,mBAI5BQ,EAAWL,mBAAkB,SAAUtG,GACjCrH,EAAoBC,EAAeoH,EAAQnH,OAC7CgM,EAAO/B,wBAAwB9C,GAC/BrL,EAAUb,OAAOL,EAAmB8S,kBAAmB,CACrD/N,SAAUwH,EAAQxH,SAClBgO,OAAQxG,EAAQwG,OAChBL,aAAcnG,EAAQmG,aACtBM,SAAUzG,EAAQyG,SAClBG,aAAc5G,EAAQ4G,aACtB5D,OAAQhD,EAAQgD,OAChBhM,UAAWgJ,EAAQhJ,UACnB+L,OAAQ/C,EAAQ+C,OAChB7I,QAAS8F,EAAQ9F,QACjB0C,KAAM,WACN/D,IAAKmH,EAAQnH,UAzDnBgO,CAAWlS,EAAWiE,EAAeiM,GAgEvC,SAASuB,KACP,IAAI/I,EAASsH,GAEb,OADAA,IAAoB,EACbtH,ECxEF,SAASyJ,GAAiBnS,EAAWR,QACzB,IAAbA,IACFA,EAAW,MAGb,IAAI4S,EAAc,CAChBC,WAAY,EACZC,cAAe,EACfC,cAAe,EACfC,gBAAiB,GAEfC,EAAezS,EAAUP,UAAUX,EAAmBgN,qBAAqB,SAAUpC,GAGvF,OAFWA,EAAGzB,MAGZ,KAAKtJ,EAAasM,MAChBmH,EAAYC,YAAc,EAC1B7S,EAAS4S,GACT,MAEF,KAAKzT,EAAa+T,OAChBN,EAAYI,iBAAmB,EAC/BhT,EAAS4S,GACT,MAEF,KAAKzT,EAAawM,UAChBiH,EAAYE,eAAiB,EAC7B9S,EAAS4S,GACT,MAEF,KAAKzT,EAAauM,SAChBkH,EAAYG,eAAiB,EAC7B/S,EAAS4S,OAIf,MAAO,CACLlR,KAAM,WACJuR,EAAa7S,eAEfwS,YAAaA,G,gBCnCV,SAASO,GAAqB3S,EAAW4S,GAC9C,IAAIlJ,EAuCC,SAA6B1J,GAClC,IAEI6S,EAFAC,EAAa,IAAI,KACjBC,EAAgB,GAEhBC,EAAuB,EA6B3B,SAASC,IACPH,EAAW3T,OAAO,CAChB+T,OAAQF,EAAuB,IAInC,OAlCAD,EAAcpT,KAAKK,EAAUP,UAAUX,EAAmB4B,aAAa,WACrE,OAAOuS,QAETF,EAAcpT,KAAKK,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GACvE,aAApBA,EAAM+D,WAIVgN,QAEFF,EAAcpT,KAAKK,EAAUP,UAAUX,EAAmB4S,iBAAiB,SAAUyB,QACzDrN,IAAtB+M,IACFA,EAAoBM,EAAW3B,cAGjCwB,GAAwB,EACxBC,QAEFF,EAAcpT,KAAKK,EAAUP,UAAUX,EAAmB8S,mBAAmB,SAAUwB,QAE3DtN,IAAtB+M,GAAmCO,EAAQ5B,aAAeqB,IAI9DG,GAAwB,EACxBC,SASK,CACLH,WAAYA,EACZ5R,KAAM,WACJ6R,EAAcxT,SAAQ,SAAU8T,GAC9B,OAAOA,EAAEzT,mBAlFN0T,CAAoBtT,GACzBuT,EAA2B7J,EAAGoJ,WAC9BU,EAA6B9J,EAAGxI,KAEhCuS,EAmFC,SAAsCF,EAA0BC,EAA4BZ,GACjG,IAAIc,EACAC,GAAe,EACfC,EAAsBpM,YAAW,SAAQ,WAC3C,OAAOqM,GAAS,EAAO,MAjGiB,KAmGtCC,EAAuBtM,YAAW,SAAQ,WAC5C,OAAOqM,GAAS,GAAM,cAhGc,KAkGtCN,EAAyB9T,WAAU,SAAUiK,GAC3C,IAAIwJ,EAASxJ,EAAGwJ,OAChBa,aAAaH,GACbG,aAAaL,GACb,IAAIM,GAAiB,UAEhBd,IACHQ,EAAgBlM,YAAW,SAAQ,WACjC,OAAOqM,GAAS,EAAMG,MA5GO,SAiHnC,IAAI9S,EAAO,WACTyS,GAAe,EACfI,aAAaH,GACbG,aAAaL,GACbK,aAAaD,GACbN,KAGF,SAASK,EAASI,EAAarH,GACzB+G,IAIJzS,IACA0R,EAAmBqB,EAAarH,IAGlC,MAAO,CACL1L,KAAMA,GA3H+BgT,CAA6BX,EAA0BC,EAA4BZ,GAAoB1R,KAO9I,MAAO,CACLA,KANS,WACTuS,IACAD,MChBG,SAASW,GAAyBC,GAOvC,OAQF,SAAkDC,GAChD,IAAIC,EAKJ,GA8MF,gBACuCxO,IAAjCyO,KACFA,GAA+B,YAAaC,YAAYtV,WAG1D,OAAOqV,GAnNHE,GACFH,EAAuBD,EAAcK,QAAQ,8BAI7C,IAFA,IAAIN,EAAUC,EAEPD,GAAS,CACd,GAAIA,EAAQO,aAAaC,IAAyB,CAChDN,EAAuBF,EACvB,MAGFA,EAAUA,EAAQS,cAItB,IAAKP,EACH,OAIF,OAAOQ,GAASC,GADLT,EAAqBU,aAAaJ,IACJK,SAlClCC,CAAyCd,IAAYe,GAAsCf,EAASgB,KAAuBD,GAAsCf,EAASiB,KAAuB,GAM1M,IAAIT,GAAyB,sBA+B7B,IA6IIU,GAuBAC,GAiBAhB,GArLAa,GAAqB,CACzB,SAAUhB,GAGR,GAkKF,gBACsCtO,IAAhCyP,KACFA,GAA8B,WAAYC,iBAAiBtW,WAG7D,OAAOqW,GAvKHE,IACF,GAAI,WAAYrB,GAAWA,EAAQsB,QAAUtB,EAAQsB,OAAO3T,OAAS,EACnE,OAAO4T,GAAkBvB,EAAQsB,OAAO,SAErC,GAAItB,EAAQnK,GAAI,CACrB,IAAI2L,EAAQxB,EAAQyB,eAAiBzB,EAAQyB,cAActR,cAAc,cAAiB6P,EAAQnK,GAAG6L,QAAQ,IAAK,OAAS,MAC3H,OAAOF,GAASD,GAAkBC,KAGtC,SAAUxB,GACR,GAAyB,UAArBA,EAAQ1O,SAAsB,CAChC,IAAI2K,EAAQ+D,EACRnM,EAAOoI,EAAM2E,aAAa,QAE9B,GAAa,WAAT/M,GAA8B,WAATA,GAA8B,UAATA,EAC5C,OAAOoI,EAAMS,QAInB,SAAUsD,GACR,GAAyB,WAArBA,EAAQ1O,UAA8C,UAArB0O,EAAQ1O,UAAyD,WAAjC0O,EAAQY,aAAa,QACxF,OAAOW,GAAkBvB,IAE1B,SAAUA,GACX,OAAOA,EAAQY,aAAa,eAE9B,SAAUZ,GACR,IAAI2B,EAAsB3B,EAAQY,aAAa,mBAE/C,GAAIe,EACF,OAAOA,EAAoBC,MAAM,OAAOC,KAAI,SAAUhM,GACpD,OAkEN,SAAwBiM,EAAYjM,GAGlC,OAAOiM,EAAWL,cAAgBK,EAAWL,cAAcM,eAAelM,GAAM,KArErEkM,CAAe/B,EAASnK,MAC9BpK,QAAO,SAAU+V,GAClB,OAAOQ,QAAQR,MACdK,IAAIN,IAAmBU,KAAK,MAEhC,SAAUjC,GACX,OAAOA,EAAQY,aAAa,QAC3B,SAAUZ,GACX,OAAOA,EAAQY,aAAa,SAC3B,SAAUZ,GACX,OAAOA,EAAQY,aAAa,UAC3B,SAAUZ,GACX,OAAOA,EAAQY,aAAa,gBAE9B,SAAUZ,GACR,GAAI,YAAaA,GAAWA,EAAQkC,QAAQvU,OAAS,EACnD,OAAO4T,GAAkBvB,EAAQkC,QAAQ,MAGzCjB,GAAqB,CAAC,SAAUjB,GAClC,OAAOuB,GAAkBvB,KAS3B,SAASe,GAAsCd,EAAekC,GAI5D,IAHA,IAAInC,EAAUC,EACVmC,EAAmB,EAEhBA,GANqB,IAM0BpC,GAAgC,SAArBA,EAAQ1O,UAA4C,SAArB0O,EAAQ1O,UAA4C,SAArB0O,EAAQ1O,UAAqB,CAC1J,IAAK,IAAI7D,EAAK,EAAG4U,EAAeF,EAAY1U,EAAK4U,EAAa1U,OAAQF,IAAM,CAC1E,IACI6U,GAASC,EADEF,EAAa5U,IACNuS,GAEtB,GAAsB,iBAAXsC,EAAqB,CAC9B,IAAIE,EAAcF,EAAOzB,OAEzB,GAAI2B,EACF,OAAO9B,GAASC,GAAoB6B,KAO1C,GAAyB,SAArBxC,EAAQ1O,SACV,MAGF0O,EAAUA,EAAQS,cAClB2B,GAAoB,GAIxB,SAASzB,GAAoB1B,GAC3B,OAAOA,EAAEyC,QAAQ,OAAQ,KAG3B,SAAShB,GAASzB,GAChB,OAAOA,EAAEtR,OAAS,KAAM,QAAasR,EAAG,KAAO,SAAWA,EAS5D,SAASsC,GAAkBvB,GACzB,IAAIA,EAAQyC,kBAAZ,CAIA,GAAI,cAAezC,EAAS,CAC1B,IAAI0C,EAAO1C,EAAQ2C,UAEnB,IA4BJ,WACE,QAAqDjR,IAAjDwP,GAA4D,CAC9D,IAAI0B,EAAQpW,SAASqW,cAAc,SACnCD,EAAME,YAAc,IACpB,IAAIC,EAAMvW,SAASqW,cAAc,OACjCE,EAAIC,YAAYJ,GAChBpW,SAASmE,KAAKqS,YAAYD,GAC1B7B,GAAiE,KAAlB6B,EAAIJ,UACnDnW,SAASmE,KAAKsS,YAAYF,GAG5B,OAAO7B,GAvCAgC,GAKH,IAFA,IAAIC,EAAuBnD,EAAQoD,iBAAiB,iBAE3CxV,EAAI,EAAGA,EAAIuV,EAAqBxV,OAAQC,GAAK,EAAG,CACvD,IAAI+U,EAAYQ,EAAqBvV,GAAG+U,UAEpCA,EAAU9B,OAAOlT,OAAS,IAC5B+U,EAAOA,EAAKhB,QAAQiB,EAAW,KAKrC,OAAOD,EAGT,OAAO1C,EAAQ8C,aC3KV,SAASO,GAAazX,GAC3B,IAAIiN,EA8BN,SAA+BjN,GAC7B,IAAIoM,EACAsL,EACJ,MAAO,CACLC,OAAQ,SAAgB1P,EAAMnB,GAC5B,IAAIsF,EAAJ,CAKA,IAAIwL,EAAoB,IAAIC,GAAkB7X,EAAWiI,EAAMnB,GAC/DsF,EAAgBwL,EAChBF,EAAsC/E,GAAqB3S,GAAW,SAAUiU,EAAarH,GACvFqH,EACF2D,EAAkB/D,SAASjH,GAE3BgL,EAAkBE,UAGpB1L,OAAgBtG,OAGpBiS,eAAgB,WACV3L,IACFsL,EAAoCxW,OACpCkL,EAAc0L,UACd1L,OAAgBtG,KAxDTkS,CAAsBhY,GAEnCA,EAAUP,UAAUX,EAAmB0N,cAAc,WACnDS,EAAO8K,oBAET,IAAIE,GAAe,QAAiB5X,OAAQ,SAE1C,SAAUiI,GACV,GAAMA,EAAM4P,kBAAkBC,QAA9B,CAIA,IAAIrR,EAAOqN,GAAyB7L,EAAM4P,QAErCpR,GAILmG,EAAO0K,OAAO9Y,EAAWuZ,MAAOtR,MAC/B,CACDuB,SAAS,IACRnH,KACH,MAAO,CACLA,KAAM,WACJ+L,EAAO8K,iBACPE,MAqCN,IAAIJ,GAEJ,WACE,SAASA,EAAkB7X,EAAWiI,EAAMnB,GAC1C9H,KAAKgB,UAAYA,EACjBhB,KAAKiJ,KAAOA,EACZjJ,KAAK8H,KAAOA,EACZ9H,KAAKiL,IAAK,UACVjL,KAAKqD,WAAY,UACjBrD,KAAKqZ,wBAA0BlG,GAAiBnS,GAChDhB,KAAKgB,UAAUb,OAAOL,EAAmBiO,oBAAqB,CAC5D9C,GAAIjL,KAAKiL,GACT5H,UAAWrD,KAAKqD,YA0BpB,OAtBAwV,EAAkB3Y,UAAU2U,SAAW,SAAUjH,GAC/C,IAAIwF,EAAcpT,KAAKqZ,wBAAwBjG,YAC/CpT,KAAKgB,UAAUb,OAAOL,EAAmBkO,sBAAuB,CAC9DsL,OAAQ,CACNjG,WAAYD,EAAYC,WACxBC,cAAeF,EAAYE,cAC3BC,cAAeH,EAAYG,eAE7B1O,UAAU,QAAQ7E,KAAKqD,UAAWuK,GAClC3C,GAAIjL,KAAKiL,GACTnD,KAAM9H,KAAK8H,KACXzE,UAAWrD,KAAKqD,UAChB4F,KAAMjJ,KAAKiJ,OAEbjJ,KAAKqZ,wBAAwBnX,QAG/B2W,EAAkB3Y,UAAU4Y,QAAU,WACpC9Y,KAAKgB,UAAUb,OAAOL,EAAmBqO,uBACzCnO,KAAKqZ,wBAAwBnX,QAGxB2W,EApCT,GClEO,SAASU,GAAsBvY,EAAWiE,GAS/C,OARAjE,EAAUP,UAAUX,EAAmBkO,uBAAuB,SAAUC,GACtE,OAAOjN,EAAUb,OAAOL,EAAmB2K,wBAAyB+O,GAAcvL,OAGhFhJ,EAAcwU,mBAChBhB,GAAazX,GAGR,CACL0Y,UAAW,SAAmBzL,EAAQrD,GACpC5J,EAAUb,OAAOL,EAAmB2K,yBAAyB,QAAS,CACpEG,mBAAoBA,GACnB4O,GAAcvL,OAKvB,SAASuL,GAAcvL,GACrB,IAAI0L,EAAuBC,GAAa3L,GAAU,CAChDA,OAAQ,CACN4L,MAAO,CACLC,MAAO7L,EAAOqL,OAAOjG,YAEvBpI,GAAIgD,EAAOhD,GACX8O,cAAc,QAAiB9L,EAAOpJ,UACtCmV,UAAW,CACTF,MAAO7L,EAAOqL,OAAOhG,eAEvB2G,SAAU,CACRH,MAAO7L,EAAOqL,OAAO/F,sBAGvBzM,EAYJ,MAAO,CACL+D,gBAZqB+O,GAAa3L,QAA2BnH,EAAjBmH,EAAO5B,QAanD1B,aAZgB,QAAQ,CACxBsD,OAAQ,CACNiL,OAAQ,CACNpR,KAAMmG,EAAOnG,MAEfmB,KAAMgF,EAAOhF,MAEfwC,MAAM,QAAawC,EAAO5K,WAC1B4F,KAAMtJ,EAAa+T,QAClBiG,GAIDtW,UAAW4K,EAAO5K,WAItB,SAASuW,GAAa3L,GACpB,OAAOA,EAAOhF,OAASpJ,EAAWqa,O,ICzDhCC,G,wBCGG,SAASC,GAAqBpZ,EAAWiE,GAC9C,OAEK,SAAgCjE,EAAW8S,GAIhD,OAHAA,EAAWrT,WAAU,SAAUoZ,GAC7B,OAAO7Y,EAAUb,OAAOL,EAAmB2K,wBAAyB4P,GAAaR,OAE5E,CACLS,SAAU,SAAkB5P,EAAIE,GAC9B,IAAIiP,EAAQnP,EAAGmP,MACXxW,EAAYqH,EAAGrH,UACfwH,EAAkBH,EAAG2B,QAErBkO,EASV,SAAyBV,EAAOxW,EAAWmX,GACzC,IAAIC,EAAaZ,aAAiBa,OAAQ,EAAAC,GAAA,IAAkBd,QAAS/S,EACrE,OAAO,QAAS,CACdzD,UAAWA,EACXmX,OAAQA,IACP,QAAmBC,EAAYZ,EAAO,aAdtBe,CAAgBf,EAAOxW,EADzBqH,EAAG8P,QAEhBxZ,EAAUb,OAAOL,EAAmB2K,yBAAyB,QAAS,CACpEI,gBAAiBA,EACjBD,mBAAoBA,GACnByP,GAAaE,OAhBbM,CAAuB7Z,GAAW,SAA8BiE,IA6BzE,SAASoV,GAAaR,GAgBpB,MAAO,CACLlP,YAhBgB,CAChBc,MAAM,QAAaoO,EAAMxW,WACzBwW,MAAO,CACLiB,QAASjB,EAAMiB,QACfb,SAAUJ,EAAMI,SAAW,CACzBpH,OAAQgH,EAAMI,SAASpH,OACvBkI,YAAalB,EAAMI,SAASe,WAC5B9V,IAAK2U,EAAMI,SAAS/U,UAClB4B,EACJ0T,OAAQX,EAAMW,OACdS,MAAOpB,EAAMoB,MACbhS,KAAM4Q,EAAM5Q,MAEdA,KAAMtJ,EAAasM,OAInB5I,UAAWwW,EAAMxW,WCrCd,SAAS6X,GAAmB9G,GACjC,GAAKrN,aAAiB,qBAAsBA,YAA5C,CAIA,IAAIoU,EAAkBpU,YAAYqU,iBAAiBhH,EAAQlP,IAAK,YAEhE,GAAKiW,EAAgBpY,QAAY,WAAYoY,EAAgB,GAA7D,CAIA,IAiB+BE,EAjB3BC,EAAaH,EAAgBlE,KAAI,SAAU/T,GAC7C,OAAOA,EAAMyE,YACZ9G,OAAOuC,GAAcvC,QAAO,SAAUqC,GACvC,OAuBeoE,EAvBEpE,EAuBMyB,EAvBCyP,EAAQ/Q,UAuBFuB,EAvBagJ,GAAQwG,GAwB9C9M,EAAOjE,WAAasB,GAASiJ,GAAQtG,IAAW1C,EADzD,IAAmB0C,EAAQ3C,EAAOC,KApBhC,OAA0B,IAAtB0W,EAAWvY,OACNuY,EAAW,GAGM,IAAtBA,EAAWvY,QAQR6K,IADwByN,EAPwBC,GAQnB,KAAOD,EAAqB,GAAGhY,UAP1DiY,EAAW,QADpB,IAWF,SAAS1N,GAAQtG,GAEf,OAAOA,EAAOjE,UAAYiE,EAAOzC,SC3C5B,SAAS0W,GAAwBva,EAAWsJ,GACjDtJ,EAAUP,UAAUX,EAAmB8S,mBAAmB,SAAUwB,GAC9D9J,EAAQkR,yBACVxa,EAAUb,OAAOL,EAAmB2K,wBAU1C,SAAwB2J,GACtB,IAAInL,EAAOmL,EAAQnL,OAAS,SAAkB,SAAmB,WAC7DwS,EAAiBP,GAAmB9G,GACpC/Q,EAAYoY,EAAiBA,EAAepY,UAAY+Q,EAAQ/Q,UAChEqY,EAA+BD,EAAiBE,GAA+BF,QAAkB3U,EACjG8U,EA6CN,SAAmCxH,GAGjC,IAFoBA,EAAQ7N,UAAW6N,EAAQ/E,OAG7C,OAGF,MAAO,CACL/D,IAAK,CACHuQ,QAASzH,EAAQ/E,OAAOW,kBACxB8L,SAAU1H,EAAQ7N,QAAQyJ,mBAE5BiK,SAAU,CACRhP,IAAI,YA1DU8Q,CAA0B3H,GACxC4H,GAAgB,QAAQ,CAC1BvQ,MAAM,QAAapI,GACnB4W,SAAU,CACRhR,KAAMA,EACNpE,UAAU,QAAiBuP,EAAQvP,UACnCgO,OAAQuB,EAAQvB,OAChBkI,YAAa3G,EAAQhF,OACrBlK,IAAKkP,EAAQlP,KAEf+D,KAAMtJ,EAAauM,UAClB0P,EAAaF,GAChB,MAAO,CACLrY,UAAWA,EACXsH,YAAaqR,GA7BkDC,CAAe7H,OAGhFpT,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GfiDzE,IAAuBoE,EehDtBgD,EAAQkR,yBAA+C,aAApBtY,EAAM+D,YfiDf,oBADJK,EehD8DpE,GfiD5EZ,eAA+D,UAAzBgF,EAAOhF,gBehDvDtB,EAAUb,OAAOL,EAAmB2K,wBA4B1C,SAA8BvH,GAC5B,IAAI+F,EfrBC,SAA6B3B,GAClC,IAAIpC,EAAMoC,EAAOQ,KAEjB,KAAK,QAAW5C,GAEd,OADA,QAAqB,gCAAmCoC,EAAOQ,KAAO,KAC/D,WAKT,IAFA,IAAItF,GAAO,QAAY0C,GAEdrC,EAAK,EAAGqZ,EAAmB7Z,EAAgBQ,EAAKqZ,EAAiBnZ,OAAQF,IAAM,CACtF,IAAI6H,EAAKwR,EAAiBrZ,GACtBoG,EAAOyB,EAAG,GAGd,IAAIyR,EAFSzR,EAAG,IAELpD,EAAOhF,cAAeE,GAC/B,OAAOyG,EAIX,OAAO,WeCImT,CAAoBlZ,GAC3BmZ,EAAeV,GAA+BzY,GAC9C0Y,EA0CN,SAAiC1Y,GAC/B,OAAOA,EAAMqD,QAAU,CACrB+E,IAAK,CACHwQ,SAAU5Y,EAAMqD,eAEhBO,EA/CcwV,CAAwBpZ,GACtC8Y,GAAgB,QAAQ,CAC1BvQ,MAAM,QAAavI,EAAMG,WACzB4W,SAAU,CACRhR,KAAMA,EACN/D,IAAKhC,EAAM4E,MAEbmB,KAAMtJ,EAAauM,UAClB0P,EAAaS,GAChB,MAAO,CACLhZ,UAAWH,EAAMG,UACjBsH,YAAaqR,GA1CkDO,CAAqBrZ,OA8CxF,SAASyY,GAA+BrU,GACtC,MAAO,CACL2S,UAAU,QAAS,CACjBpV,UfC6C3B,EeDAoE,EfE7CzC,EAAW3B,EAAM2B,SACjBxB,EAAYH,EAAMG,UAClBc,EAAcjB,EAAMiB,YAEP,IAAbU,GAAkBxB,EAAYc,GACzB,SAAiB,QAAQd,EAAWc,KAGtC,QAAiBU,IeTpB2X,KAAM1X,EAAYwC,IACjBrE,EAAkCqE,KfDlC,IAA4CpE,EAC7C2B,EACAxB,EACAc,EYhEC,SAASsY,GAAiBC,GA0B/B,YAzBgB,IAAZA,IACFA,EAAUrb,QAGP8Y,KAC8B,WAA7BvY,SAAS+a,gBACXxC,GAA4B,CAC1BnR,UAAW,IAGbmR,GAA4B,CAC1BnR,UAAW4T,MAEG,QAAiBF,EAAS,YAExC,SAAUhS,GACV,IAAI1B,EAAY0B,EAAG1B,UACnBmR,GAA0BnR,UAAYA,IACrC,CACDK,SAAS,EACTE,MAAM,IACLrH,OAIAiY,GIzBF,SAAS0C,GAAa7b,EAAWR,GACtC,IAAIsc,EAEJ,SAASC,EAAWC,GAClBF,GAAU,SAAS,QAAS,GAAIA,GAAUE,GAC1Cxc,EAASsc,GAGX,IAAIG,EA4BC,SAAgCjc,EAAWR,GAWhD,MAAO,CACL0B,KAXSlB,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GAC/D,eAApBA,EAAM+D,WACRzG,EAAS,CACP0c,YAAaha,EAAMga,YACnBC,iBAAkBja,EAAMka,yBACxBC,eAAgBna,EAAMma,eACtBC,UAAWpa,EAAM4G,kBAGpBlJ,aAtC0B2c,CAAuBvc,EAAW+b,GAAY7a,KACvEsb,EA0CC,SAAmCxc,EAAWR,GACnD,IAAIid,EAAchB,KAMlB,MAAO,CACLva,KANSlB,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GAC/D,UAApBA,EAAM+D,WAAwC,2BAAf/D,EAAM4E,MAAqC5E,EAAMG,UAAYoa,EAAYzU,WAC1GxI,EAAS0C,EAAMG,cAEhBzC,aAhDmB8c,CAA0B1c,GAAW,SAAU2c,GACnE,OAAOZ,EAAW,CAChBY,qBAAsBA,OAEvBzb,KACC0b,EAuDC,SAAqC5c,EAAW0b,EAASlc,GAC9D,IAAIid,EAAchB,KAIdoB,EAA4BjB,IAC5BkB,GAAoB,QAAkBpB,EAAS,CAAC,cAElD,YAEC,SAAUpT,GACXuU,EAA4BvU,EAAMN,YACjC,CACDK,SAAS,EACTE,MAAM,IACLrH,KACC6b,EAAuB/c,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GAC/E,6BAApBA,EAAM+D,WAA4C/D,EAAMG,UAAYwa,GAA6B3a,EAAMG,UAAYoa,EAAYzU,WACjIxI,EAAS0C,EAAMG,cAEhBzC,YACH,MAAO,CACLsB,KAAM,WACJ4b,IACAC,MA/EkBC,CAA4Bhd,EAAWK,QAAQ,SAAU4c,GAC7ElB,EAAW,CACTkB,uBAAwBA,OAEzB/b,KACCgc,EAuFC,SAAgCld,EAAWR,GAChD,IAAIid,EAAchB,KAoBlB,MAAO,CACLva,KApBSlB,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GAC/D,gBAApBA,EAAM+D,WAA+B/D,EAAMG,UAAYoa,EAAYzU,YAGjE9F,EAAMG,WAAaH,EAAM6F,gBAC3BvI,EAAS,CACP2d,iBAAiB,QAAQjb,EAAMG,UAAWH,EAAM6F,iBAChDqV,eAAgBlb,EAAMG,YAEfH,EAAMyE,SACf,QAAqB,0BAA4BzE,EAAM4E,KAAM,CAC3D5E,OAAO,SAAS,QAAS,GAAIA,EAAMyE,UAAW,CAC5CuR,YAAQpS,IAEVuX,IAAKnb,EAAM6F,gBAAkB7F,EAAMG,gBAIxCzC,aA3GmB0d,CAAuBtd,GAAW,SAAU0J,GAGhEqS,EAAW,CACToB,gBAHoBzT,EAAGyT,gBAIvBC,eAHmB1T,EAAG0T,oBAKvBlc,KACH,MAAO,CACLA,KAAM,WACJ+a,IACAO,IACAI,IACAM,MC5BC,IACIK,GAA8B,EAAI,KACtC,SAASC,GAAWzW,EAAU/G,EAAWyd,GAC9C,IAAI/T,OAEkB,IAAlB+T,IACFA,EAAgB,cAKlB,IA0NiBC,EAzNbC,EAAcC,GAAQ5d,EAAW+G,EAAUnI,EAAgBif,aAAcjd,SAASiN,SADpE,EAC8H,QAAlCnE,EAAK+T,EAAc1W,UAA8B,IAAP2C,OAAgB,EAASA,EAAGoU,UAChL3R,EAAcwR,EACdI,EAAsBlC,GAAa7b,GAAW,SAAU8b,GAC1D6B,EAAYK,cAAclC,GAC1B6B,EAAYM,oBACX/c,KACCgd,EAuLN,SAAsBC,GAEpB,IAAIC,EAAoBC,QAAQC,UAChCD,QAAQC,WAAY,SAAQ,WAC1BF,EAAkBG,MAAMvf,KAAM8C,WAC9Bqc,OAGF,IAAIK,EAAuBH,QAAQI,aACnCJ,QAAQI,cAAe,SAAQ,WAC7BD,EAAqBD,MAAMvf,KAAM8C,WACjCqc,OAEF,IAAIO,GAAiB,QAAiBre,OAAQ,WAE5C8d,GAAiBjd,KAQnB,MAAO,CACLA,KAPS,WACTwd,IACAL,QAAQC,UAAYF,EACpBC,QAAQI,aAAeD,IA3MCG,CAAaC,GAAkB1d,KACrD2d,GAkNanB,EAlNgBkB,GAmN1B,QAAiBve,OAAQ,aAE9Bqd,IArNiDxc,KAEnD,SAAS0d,IACP,IAAIlV,EAAK+T,EAAc1W,EAAUoF,EAAY2S,gBAAkB,GAC3DhB,EAAWpU,EAAGoU,SACdiB,EAAmBrV,EAAGqV,iBAE1B,GAAIA,QAAyCjZ,IAArBiZ,GAAkC5S,EAAY6S,gBAAgBjY,GAKpF,OAHAoF,EAAYvI,MACZuI,EAAY8S,qBACZ9S,EAAcyR,GAAQ5d,EAAW+G,EAAUnI,EAAgBsgB,aAAc/S,EAAYjI,SAAK4B,EAAWgY,IAIvG3R,EAAYgT,eAAepY,GAC3BoF,EAAY8S,gBAIdjf,EAAUP,UAAUX,EAAmBsO,iBAAiB,WAEtDjB,EAAYvI,MACZuI,EAAcyR,GAAQ5d,EAAW+G,EAAUnI,EAAgBsgB,aAAc/S,EAAYjI,QAGvFlE,EAAUP,UAAUX,EAAmBsgB,eAAe,WACpDjT,EAAYvI,MACZuI,EAAY8S,mBAGd,IAAII,EAAoBhf,OAAOiN,aAAY,SAAQ,WACjDnB,EAAY8S,mBACV1B,IACJ,MAAO,CACL+B,UAAW,SAAmBxY,EAAMyY,QACrB,IAATA,IACFA,GAAO,WAGTpT,EAAYmT,UAAUxY,EAAMyY,GAC5BpT,EAAY8S,iBAEd/d,KAAM,WACJgd,IACAW,IACAd,IACA5R,EAAYvI,MACZsK,cAAcmR,KAKpB,SAASzB,GAAQ5d,EAAWwf,EAAiBC,EAAa5R,EAAUxL,EAAWyE,QAC3D,IAAdzE,IACFA,GAAY,WAId,IAUIqd,EACAC,EACA/S,EAZA3C,GAAK,UACLmI,EAAc,CAChBC,WAAY,EACZC,cAAe,EACfC,cAAe,EACfC,gBAAiB,GAEfsJ,EAAU,GACV8D,EAAgB,GAChBC,EAAkB,EAKlB9Y,GAAW,QAAS,GAAIyY,GAE5Bxf,EAAUb,OAAOL,EAAmB0N,aAAc,CAChDvC,GAAIA,EACJ5H,UAAWA,EACX0E,SAAUA,EACV8G,SAAUA,IAGZ,IAmBIiS,EAnBApW,GAAK,SAAS,QAAQqW,GArGa,IAqGoC,CACzEC,SAAS,IAEPC,EAAqBvW,EAAGwW,UACxBC,EAA2BzW,EAAG0W,OAE9BC,EAA0BlO,GAAiBnS,GAAW,SAAUsgB,GAClElO,EAAckO,EACdL,OACC/e,KAECqf,EA2HN,SAA0BC,EAAUhhB,GAClC,IAAIihB,EAAwBD,IAAa5hB,EAAgBif,aACrD6C,GAAkC,EAClCC,EAAwB,GAE5B,SAASC,KACFF,IAAoCD,GAAyBE,EAAsB5e,OAAS,GAC/FvC,EAASqQ,KAAKgR,IAAItC,MAAM1O,KAAM8Q,IAIlC,MAAO,CACLG,aAAc,SAAsBxE,GAC9BmE,IACFA,GAAwB,EACxBE,EAAsBhhB,KAAK2c,GAC3BsE,MAGJG,uBAAwB,SAAgCC,GAClDN,IACFA,GAAkC,OAEN5a,IAAxBkb,GACFL,EAAsBhhB,KAAKqhB,GAG7BJ,OAtJGK,CAAiBxB,GAAa,SAAUyB,GAC/CvB,EAAcuB,EACdjB,OAEEc,EAAyBR,EAAGQ,uBAC5BD,EAAeP,EAAGO,aAElBK,EAqJN,SAAkCnhB,EAAWR,GAC3C,IAAI6C,GAAY,UAQhB,MAAO,CACLnB,KAR6ByR,GAAqB3S,GAAW,SAAUiU,EAAarH,GAElFpN,EADEyU,GACO,QAAQ5R,EAAWuK,QAEnB9G,MAEV5E,MA7JmCkgB,CAAyBphB,EAAW+gB,GAAwB7f,KAgBlG,SAAS6e,IACPF,GAAmB,EACnB7f,EAAUb,OAAOL,EAAmBgO,aAAc,CAChD4S,sBAAuBA,EACvBE,cAAeA,EACfC,gBAAiBA,EACjBzN,YAAaA,EACbnI,GAAIA,EACJnD,KAAMA,EACN6Y,YAAaA,EACbF,YAAaA,EACb1Y,SAAUA,EACV8G,SAAUA,EACVxL,UAAWA,EACXyZ,QAASA,EACTjY,UAAU,QAAQxB,OAAuByD,IAAZ8G,GAAwB,UAAgBA,GACrEyU,cAAsBvb,IAAZ8G,IAId,OAyJO5G,EAA8B,iBAzLnC0Z,EAAwB,EACxBI,EAwKJ,SAA0B9f,EAAWR,GAMnC,MAAO,CACL0B,KANSlB,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GAC/D,iBAApBA,EAAM+D,WAAiC/D,EAAMof,gBAC/C9hB,EAAS0C,EAAM4O,UAEhBlR,aA7KiB2hB,CAAiBvhB,GAAW,SAAUwhB,GACtD9B,GAAyB8B,EACzBvB,OACC/e,MAEH4e,EAAkB,KAIpBC,IAsBO,CACL9B,eAAgBgC,EAChBrc,IAAK,WACHgJ,GAAU,UACVyT,IACAc,IACArB,IACA9f,EAAUb,OAAOL,EAAmB2iB,aAEtCzC,gBAAiB,SAAyB0C,GACxC,OAAO3a,EAAS4a,WAAaD,EAAcC,WA+BzBC,EA/BqDF,EAAcE,KAgCrFC,EAAkBD,EAAKE,OAAO,IACzBlhB,SAASuV,eAAe0L,IAjCiEH,EAAcE,OAAS7a,EAAS6a,MA+BpI,IAAwBA,EAClBC,GA9BF/C,YAAa,WACX,OAAO/X,GAETkY,cAAe,WAEbkB,IACAJ,KAEF/B,cAAe,SAAuBhC,GACpCF,EAAUE,OAEmBlW,IAAzBkW,EAAWM,WACbwE,EAAa9E,EAAWM,YAG5BgD,UAAW,SAAmBxY,EAAM8F,GAClCgT,EAoIN,SAAwB9Y,GACtB,IAAIib,EAAYjb,EAAKgP,QAAQ,qBAAsB,KAE/CiM,IAAcjb,GAChB6E,QAAQC,KAAK,wBAA0B9E,EAAO,mBAAqBib,GAGrE,OAAOA,EA3IWC,CAAelb,KAAS,QAAQzE,EAAWuK,IAE3DuS,eAAgB,SAAwB8C,GACtClb,GAAW,QAAS,GAAIkb,IAG1B,UACE,OAAOlb,EAASC,OClMf,SAASkb,GAAoBliB,EAAW+G,EAAU0W,GAIvD,OAHAzd,EAAUP,UAAUX,EAAmBgO,cAAc,SAAUc,GAC7D,OAAO5N,EAAUb,OAAOL,EAAmB2K,wBAK/C,SAA2BmE,GACzB,IAAIuU,EAAY,CACd7X,IAAK,CACH8X,iBAAkBxU,EAAKiS,iBAEzBpV,MAAM,QAAamD,EAAKvL,WACxB4F,KAAMtJ,EAAa+M,KACnBkC,KAAM,CACJX,OAAQ,CACN6L,MAAOlL,EAAKwE,YAAYI,iBAE1B6P,wBAAyBzU,EAAK8R,sBAC9B4C,cAAc,QAAiB1U,EAAKkO,QAAQI,aAC5CqG,oBAAoB,QAAiB3U,EAAKkO,QAAQK,kBAClDqG,iBAAiB,QAAiB5U,EAAKkO,QAAQO,gBAC/CxD,MAAO,CACLC,MAAOlL,EAAKwE,YAAYC,YAE1BoQ,wBAAwB,QAAiB7U,EAAKkO,QAAQa,sBACtD+F,mBAAmB,QAAiB9U,EAAKkO,QAAQqB,iBACjDwF,kBAAkB,QAAiB/U,EAAKkO,QAAQsB,gBAChDwF,UAAWhV,EAAKyT,SAChBva,KAAM8G,EAAK9G,KACX+b,0BAA0B,QAAiBjV,EAAKkO,QAAQmB,wBACxD6F,YAAY,QAAiBlV,EAAKkO,QAAQQ,WAC1CvD,cAAc,QAAiBnL,EAAK+R,aACpCoD,aAAcnV,EAAK6R,YACnBzG,UAAW,CACTF,MAAOlL,EAAKwE,YAAYE,eAE1B2G,SAAU,CACRH,MAAOlL,EAAKwE,YAAYG,eAE1ByQ,YAAY,QAAiBpV,EAAK/J,aAIjC,QAAc+J,EAAKgS,iBACtBuC,EAAUvU,KAAKqV,gBAAiB,QAAUrV,EAAKgS,cAAe,OAGhE,MAAO,CACLjW,YAAawY,EACb9f,UAAWuL,EAAKvL,WAhDoD6gB,CAAkBtV,OAEjF4P,GAAWzW,EAAU/G,EAAWyd,GCNlC,IACI0F,GAQJ,SAASC,GAAgBnf,EAAejE,GAC7C,IAAIsJ,GAAU,QAAuBrF,EAAcof,cAVxB,OAUwD,SAAUC,GAC3F,OAgBJ,SAA6Brf,EAAeqf,GAC1C,IAAIC,EASFA,EASJ,SAA4BA,GAC1B,OAAOA,IAAiBJ,GAAgBK,aAAeD,IAAiBJ,GAAgBM,wBAA0BF,IAAiBJ,GAAgBO,0BAjB/IC,CAAmBL,GACNA,GACL,QAAYrf,EAAc2f,aAE1B,QAAY3f,EAAc4f,oBAGrBV,GAAgBM,uBAFhBN,GAAgBO,0BAFhBP,GAAgBK,YAOjC,MAAO,CACLD,aAAcA,EACdvZ,UAAW8Z,GAAWP,IA/BfQ,CAAoB9f,EAAeqf,MAK5C,OAHAha,EAAQ0a,gBAAgBvkB,WAAU,WAChCO,EAAUb,OAAOL,EAAmBsO,oBAE/B,CACLP,MAAOvD,EAAQuD,MACf7C,UAAW,WACT,YAA2BlE,IAApBwD,EAAQuD,SAAyBiX,GAAWxa,EAAQ2a,oBAE7DzJ,sBAAuB,WACrB,YAA2B1U,IAApBwD,EAAQuD,SAAyBvD,EAAQ2a,oBAAsBd,GAAgBM,yBA4B5F,SAASK,GAAWI,GAClB,OAAOA,IAAmBf,GAAgBM,wBAA0BS,IAAmBf,GAAgBO,2BAhDzG,SAAWP,GACTA,EAA6B,YAAI,IACjCA,EAAwC,uBAAI,IAC5CA,EAA2C,0BAAI,IAHjD,CAIGA,KAAoBA,GAAkB,K,gBCNlC,SAASgB,GAAclgB,EAAejE,GAC3C,IAAIokB,EAeN,SAAsBngB,EAAejE,GACnC,IAGIqkB,EAHAC,EAAeC,EAAetgB,EAAcugB,aAAa,WAC3D,OAAOxkB,EAAUb,OAAOL,EAAmBsgB,kBAGzCqF,EAAUxgB,EAAcwgB,aAEZ3e,IAAZ2e,IACFJ,EAAeE,EAAeE,EAAQD,cAGxC,SAASD,EAAeG,EAAaC,GACnC,OAAO,IAAI,KAAM,IAAI,KAAYD,EAAazgB,EAAc2gB,iBAAiB,GAAO3gB,EAAc4gB,aAAc5gB,EAAc2gB,gBAAiB3gB,EAAc6gB,eAAgB7gB,EAAc8gB,aAAcJ,GAG3M,SAASK,EAAyBlL,GAChC,OAAO,QAAQA,EAAS,CACtBtP,YAAa,CACXP,GAAIwa,EAAQpb,iBAKlB,IAAI4b,GAAU,EACd,MAAO,CACLC,IAAK,SAAapL,GACZmL,IAIJX,EAAaY,IAAIpL,GAEbuK,GACFA,EAAaa,IAAIF,EAAyBlL,MAG9C5Y,KAAM,WACJ+jB,GAAU,GAEZE,OAAQ,SAAgBrL,EAASnR,GAC3Bsc,IAIJX,EAAaa,OAAOrL,EAASnR,GAEzB0b,GACFA,EAAac,OAAOH,EAAyBlL,GAAUnR,MA9DjDyc,CAAanhB,EAAejE,GAQxC,OAPAA,EAAUP,UAAUX,EAAmBgN,qBAAqB,SAAUd,GAChEA,EAAe/C,OAAStJ,EAAa+M,KACvC0Y,EAAMe,OAAOna,EAAgBA,EAAe4C,KAAK3D,IAEjDma,EAAMc,IAAIla,MAGP,CACL9J,KAAM,WACJkjB,EAAMljB,SCdL,IAAImkB,GAAW,CACpBC,UAAW,UACXC,WAAY,KACZC,WAAY,SCDP,IAAIC,GCAJ,SAA0BC,GAC/B,IAAIC,GAAuB,EACvBC,GAAuB,SACvBta,EAAO,GAEPua,EAA6B,aAI7BC,EAAsB,IAAI,IAE1BC,EAAoB,SAA2Bjf,GACjDgf,EAAoBZ,IAAI,CAACpe,GAAM,aAG7Bkf,EAAsB,IAAI,IAE1BC,EAAoB,SAA2BhZ,GACjD+Y,EAAoBd,IAAI,CAACjY,EAAQiZ,OAG/BC,EAAqB,IAAI,IAEzBC,EAAmB,SAA0BC,GAC/CF,EAAmBjB,IAAI,CAACmB,EAAeH,OAGzC,SAASA,IACP,OAAO,QAAU,CACf7a,QAASua,EAAqBU,MAC9Bhb,KAAMA,IAIV,IAAIib,GAAY,QAAc,CAC5BhW,MAAM,SAAQ,SAAUiW,GACtB,IAAI9c,GAEC,SAAuB,QAAmB8c,MAAwB,WAgH3E,SAAoBA,GAClB,GAAIb,EAKF,OAJKa,EAAkBC,oBACrB9a,QAAQkN,MAAM,mCAGT,EAGT,IAAK2N,IAAsBA,EAAkBE,cAAgBF,EAAkBG,aAE7E,OADAhb,QAAQkN,MAAM,+DACP,EAGT,IAAK2N,EAAkBnd,cAErB,OADAsC,QAAQkN,MAAM,qEACP,EAGT,QAAqC/S,IAAjC0gB,EAAkB5C,cAA6B,QAAa4C,EAAkB5C,YAEhF,OADAjY,QAAQkN,MAAM,qDACP,EAGT,QAA6C/S,IAAzC0gB,EAAkB3C,sBAAqC,QAAa2C,EAAkB3C,oBAExF,OADAlY,QAAQkN,MAAM,8DACP,EAGT,GAAI9H,MAAMC,QAAQwV,EAAkB7X,wBAA6E,IAAnD6X,EAAkB7X,sBAAsB5M,aAA8C+D,IAA9B0gB,EAAkB9b,QAEtI,OADAiB,QAAQkN,MAAM,0DACP,EAGT,OAAO,EAlJ4F+N,CAAWJ,KAIxGA,EAAkBG,eACpBH,EAAkBE,YAAcF,EAAkBG,cAIpDjd,EAAKgc,EAAac,GAAmB,WACnC,MAAO,CACLlb,KAAMA,EACND,QAASua,EAAqBU,UAE9BL,EAAoBvc,EAAGgP,UAAW0N,EAAmB1c,EAAG4P,SAAUyM,EAAoBrc,EAAG4V,UAAWuG,EAA6Bnc,EAAGmd,mBACxIb,EAAoBc,OAAM,SAAUpd,GAClC,IAAIuD,EAASvD,EAAG,GACZU,EAAgBV,EAAG,GACvB,OAAOuc,EAAkBhZ,EAAQ7C,MAEnC+b,EAAmBW,OAAM,SAAUpd,GACjC,IAAImP,EAAQnP,EAAG,GACXU,EAAgBV,EAAG,GACvB,OAAO0c,EAAiBvN,EAAOzO,MAEjC0b,EAAoBgB,OAAM,SAAUpd,GAClC,IAAI5C,EAAO4C,EAAG,GACV6V,EAAO7V,EAAG,GACd,OAAOqc,EAAkBjf,EAAMyY,MAEjCoG,GAAuB,MAEzBoB,qBAAqB,QAAQnB,EAAqBV,KAClD8B,wBAAwB,QAAQpB,EAAqBqB,QACrDC,qBAAqB,QAAQtB,EAAqBU,KAClDa,qBAAqB,QAAQvB,EAAqBwB,KAClDP,oBAAoB,SAAQ,SAAUxkB,GACpC,OAAOwjB,EAA2BxjB,MAEpCqW,WAAW,SAAQ,SAAU5R,EAAMuE,GACjC4a,EAAkB,CAChBnf,KAAMA,EACNuE,SAAS,QAAUA,GACnBhJ,WAAW,UACX4F,KAAMpJ,EAAWqa,YAOrBmO,cAAe,SAAuBvgB,EAAMuE,GAC1Ckb,EAAU7N,UAAU5R,EAAMuE,IAE5BiO,UAAU,SAAQ,SAAUT,EAAOxN,EAASmO,GAK1C,IAAI8N,OAJW,IAAX9N,IACFA,EAAS,aAKPA,IAAW,aAAsBA,IAAW,cAAuBA,IAAW,YAChF8N,EAAgB9N,GAEhB7N,QAAQkN,MAAM,oCAAsCW,EAAS,KAC7D8N,EAAgB,aAGlBlB,EAAiB,CACfvN,MAAOA,EACPxN,SAAS,QAAUA,GACnBmO,OAAQ8N,EACRjlB,WAAW,eAGfid,WAAW,SAAQ,SAAUxY,GAC3Bif,EAAkBjf,MAEpBygB,SAAS,SAAQ,SAAUC,GACzB,IAAIC,EAWR,SAAsBD,GACpB,GAAuB,iBAAZA,IAAyBA,EAClC,OAGF,IAAI9e,GAAS,QAAU8e,GAEnB,OAAQ9e,IACVA,EAAOuB,GAAKyd,OAAOhf,EAAOuB,KAGxB,SAAUvB,IACZA,EAAO5B,KAAO4gB,OAAOhf,EAAO5B,OAG1B,UAAW4B,IACbA,EAAOif,MAAQD,OAAOhf,EAAOif,QAG/B,OAAOjf,EA9Bekf,CAAaJ,GAE7BC,EACFnc,EAAOmc,EAEP9b,QAAQkN,MAAM,oBAAqB2O,QAIzC,OAAOjB,ED9HesB,EEcjB,SAAkBrB,EAAmBhd,GAC1C,IAAIxJ,EAAY,IAAIjB,EAEhB2K,GAAK,QAAW8c,EAAmBnB,IACnCphB,EAAgByF,EAAGzF,cACnB6jB,EAAqBpe,EAAGoe,mBAExBxe,EAAU8Z,GAAgBnf,EAAejE,GAExCiE,EAAc8jB,UAAU,mBAC3BvB,EAAkB/I,mBAAgB3X,GAGpCgiB,EAAmBE,4BAA2B,WAC5C,OAAO,QAAQ,CACbC,eAAgBzB,EAAkBnd,eACjCE,EAAeQ,WAAYP,IAAmB6B,YAGnD,IAAIkV,EAqBC,SAAiClX,EAAetC,EAAU/G,EAAWiE,EAAeqF,EAASE,EAAkBiU,GACpH,IAAIlU,EAAiB2C,EAAoBlM,EAAWsJ,GAChD8a,EAAQD,GAAclgB,EAAejE,GACzCoJ,EAAiBC,EAAepF,EAAejE,EAAWsJ,EAASC,EAAgBC,GCxD9E,SAAiCxJ,GACtCA,EAAUP,UAAUX,EAAmBmK,6BAA6B,SAAU/G,GAC5E,GAAwB,aAApBA,EAAM+D,UAAV,CAIA,IAAI0D,EAAc,CAChBc,MAAM,QAAavI,EAAMG,WACzB2W,UAAW,CACTnV,UAAU,QAAiB3B,EAAM2B,WAEnCoE,KAAMtJ,EAAawM,WAErBnL,EAAUb,OAAOL,EAAmB2K,wBAAyB,CAC3DE,YAAaA,EACbtH,UAAWH,EAAMG,gBD0CrB6lB,CAAwBloB,GACxBua,GAAwBva,EAAWsJ,GAEnC,IAAII,EAAKwY,GAAoBliB,EAAW+G,EAAU0W,IAAiB,EAAA0K,EAAA,GAAgB1K,EAAe,kCAC9F6B,EAAY5V,EAAG4V,UACf8I,EAAqB1e,EAAGxI,KAExBoY,EAAWF,GAAqBpZ,EAAWiE,GAAeqV,SAE9D,MAAO,CACLZ,UAFcH,GAAsBvY,EAAWiE,GAAeyU,UAG9DY,SAAUA,EACV/P,eAAgBA,EAChB+V,UAAWA,EACXpe,KAAM,WACJknB,IAGAhE,EAAMljB,SA3CDmnB,CAAwB7B,EAAkBnd,cAAetC,SAAU/G,EAAWiE,EAAeqF,EAASE,EAAkBgd,EAAkB/I,eAC/IlU,EAAiBgX,EAAGhX,eACpB+P,EAAWiH,EAAGjH,SACdZ,EAAY6H,EAAG7H,UACf4G,EAAYiB,EAAGjB,UAEnBrP,GAAuBjQ,EAAWiE,GAClCoC,EAA2BrG,EAAWiE,GACtClE,EAA2BC,GAC3B,IAAIsoB,EExCC,SAA8Bjf,EAAeC,EAASC,GAC3D,MAAO,CACL+c,IAAK,SAAajkB,GAChB,IAAIyH,EAAcP,EAAeQ,SAAS1H,GAE1C,GAAIiH,EAAQU,aAAeF,GAAeA,EAAYR,QAAQW,GAAI,CAChE,IAAIC,EAAgBX,EAAeY,WAAW9H,GAC9C,MAAO,CACL4lB,eAAgB5e,EAChBkf,WAAYze,EAAYR,QAAQW,GAChCue,YAAate,EAAgB,CAC3BD,GAAIC,EAAc+C,OAAOhD,SACvBnE,EACJ8H,KAAM9D,EAAY8D,SF2BJ6a,CAAqBjC,EAAkBnd,cAAeC,EAASC,GACrF,MAAO,CACLmP,UAAWA,EACXY,SAAUA,EACVgG,UAAWA,EACXrb,cAAeA,EACfjE,UAAWA,EACXuJ,eAAgBA,EAChBD,QAASA,EACTud,mBAAoByB,EAAgBhC,SFlDxC,QAAa,UAAmB,SAAUb","file":"137-0bf46df3cfdf3a80df72.js","sourcesContent":["export var RumEventType;\n\n(function (RumEventType) {\n  RumEventType[\"ACTION\"] = \"action\";\n  RumEventType[\"ERROR\"] = \"error\";\n  RumEventType[\"LONG_TASK\"] = \"long_task\";\n  RumEventType[\"VIEW\"] = \"view\";\n  RumEventType[\"RESOURCE\"] = \"resource\";\n})(RumEventType || (RumEventType = {}));\n\nexport var ViewLoadingType;\n\n(function (ViewLoadingType) {\n  ViewLoadingType[\"INITIAL_LOAD\"] = \"initial_load\";\n  ViewLoadingType[\"ROUTE_CHANGE\"] = \"route_change\";\n})(ViewLoadingType || (ViewLoadingType = {}));\n\nexport var ActionType;\n\n(function (ActionType) {\n  ActionType[\"CLICK\"] = \"click\";\n  ActionType[\"CUSTOM\"] = \"custom\";\n})(ActionType || (ActionType = {}));","export var LifeCycleEventType;\n\n(function (LifeCycleEventType) {\n  LifeCycleEventType[LifeCycleEventType[\"PERFORMANCE_ENTRY_COLLECTED\"] = 0] = \"PERFORMANCE_ENTRY_COLLECTED\";\n  LifeCycleEventType[LifeCycleEventType[\"AUTO_ACTION_CREATED\"] = 1] = \"AUTO_ACTION_CREATED\";\n  LifeCycleEventType[LifeCycleEventType[\"AUTO_ACTION_COMPLETED\"] = 2] = \"AUTO_ACTION_COMPLETED\";\n  LifeCycleEventType[LifeCycleEventType[\"AUTO_ACTION_DISCARDED\"] = 3] = \"AUTO_ACTION_DISCARDED\";\n  LifeCycleEventType[LifeCycleEventType[\"VIEW_CREATED\"] = 4] = \"VIEW_CREATED\";\n  LifeCycleEventType[LifeCycleEventType[\"VIEW_UPDATED\"] = 5] = \"VIEW_UPDATED\";\n  LifeCycleEventType[LifeCycleEventType[\"VIEW_ENDED\"] = 6] = \"VIEW_ENDED\";\n  LifeCycleEventType[LifeCycleEventType[\"REQUEST_STARTED\"] = 7] = \"REQUEST_STARTED\";\n  LifeCycleEventType[LifeCycleEventType[\"REQUEST_COMPLETED\"] = 8] = \"REQUEST_COMPLETED\";\n  LifeCycleEventType[LifeCycleEventType[\"SESSION_RENEWED\"] = 9] = \"SESSION_RENEWED\";\n  LifeCycleEventType[LifeCycleEventType[\"DOM_MUTATED\"] = 10] = \"DOM_MUTATED\";\n  LifeCycleEventType[LifeCycleEventType[\"BEFORE_UNLOAD\"] = 11] = \"BEFORE_UNLOAD\";\n  LifeCycleEventType[LifeCycleEventType[\"RAW_RUM_EVENT_COLLECTED\"] = 12] = \"RAW_RUM_EVENT_COLLECTED\";\n  LifeCycleEventType[LifeCycleEventType[\"RUM_EVENT_COLLECTED\"] = 13] = \"RUM_EVENT_COLLECTED\";\n})(LifeCycleEventType || (LifeCycleEventType = {}));\n\nvar LifeCycle =\n/** @class */\nfunction () {\n  function LifeCycle() {\n    this.callbacks = {};\n  }\n\n  LifeCycle.prototype.notify = function (eventType, data) {\n    var eventCallbacks = this.callbacks[eventType];\n\n    if (eventCallbacks) {\n      eventCallbacks.forEach(function (callback) {\n        return callback(data);\n      });\n    }\n  };\n\n  LifeCycle.prototype.subscribe = function (eventType, callback) {\n    var _this = this;\n\n    if (!this.callbacks[eventType]) {\n      this.callbacks[eventType] = [];\n    }\n\n    this.callbacks[eventType].push(callback);\n    return {\n      unsubscribe: function unsubscribe() {\n        _this.callbacks[eventType] = _this.callbacks[eventType].filter(function (other) {\n          return callback !== other;\n        });\n      }\n    };\n  };\n\n  return LifeCycle;\n}();\n\nexport { LifeCycle };","import { monitor } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../domain/lifeCycle';\n\nfunction getMutationObserverConstructor() {\n  var constructor;\n  var browserWindow = window; // Angular uses Zone.js to provide a context persisting accross async tasks.  Zone.js replaces the\n  // global MutationObserver constructor with a patched version to support the context propagation.\n  // There is an ongoing issue[1][2] with this setup when using a MutationObserver within a Angular\n  // component: on some occasions, the callback is being called in an infinite loop, causing the\n  // page to freeze (even if the callback is completely empty).\n  //\n  // To work around this issue, we are using the Zone __symbol__ API to get the original, unpatched\n  // MutationObserver constructor.\n  //\n  // [1] https://github.com/angular/angular/issues/26948\n  // [2] https://github.com/angular/angular/issues/31712\n\n  if (browserWindow.Zone) {\n    // eslint-disable-next-line no-underscore-dangle\n    var symbol = browserWindow.Zone.__symbol__('MutationObserver');\n\n    constructor = browserWindow[symbol];\n  }\n\n  if (!constructor) {\n    constructor = browserWindow.MutationObserver;\n  }\n\n  return constructor;\n}\n\nexport function startDOMMutationCollection(lifeCycle) {\n  var observer;\n  var MutationObserver = getMutationObserverConstructor();\n\n  if (MutationObserver) {\n    observer = new MutationObserver(monitor(function () {\n      lifeCycle.notify(LifeCycleEventType.DOM_MUTATED);\n    }));\n    observer.observe(document.documentElement, {\n      attributes: true,\n      characterData: true,\n      childList: true,\n      subtree: true\n    });\n  }\n\n  return {\n    stop: function stop() {\n      if (observer) {\n        observer.disconnect();\n      }\n    }\n  };\n}","import { __assign } from \"tslib\";\nimport { addMonitoringMessage, elapsed, getPathName, includes, isValidUrl, ResourceType, toServerDuration } from '@datadog/browser-core';\nexport var FAKE_INITIAL_DOCUMENT = 'initial_document';\nvar RESOURCE_TYPES = [[ResourceType.DOCUMENT, function (initiatorType) {\n  return FAKE_INITIAL_DOCUMENT === initiatorType;\n}], [ResourceType.XHR, function (initiatorType) {\n  return 'xmlhttprequest' === initiatorType;\n}], [ResourceType.FETCH, function (initiatorType) {\n  return 'fetch' === initiatorType;\n}], [ResourceType.BEACON, function (initiatorType) {\n  return 'beacon' === initiatorType;\n}], [ResourceType.CSS, function (_, path) {\n  return /\\.css$/i.test(path);\n}], [ResourceType.JS, function (_, path) {\n  return /\\.js$/i.test(path);\n}], [ResourceType.IMAGE, function (initiatorType, path) {\n  return includes(['image', 'img', 'icon'], initiatorType) || /\\.(gif|jpg|jpeg|tiff|png|svg|ico)$/i.exec(path) !== null;\n}], [ResourceType.FONT, function (_, path) {\n  return /\\.(woff|eot|woff2|ttf)$/i.exec(path) !== null;\n}], [ResourceType.MEDIA, function (initiatorType, path) {\n  return includes(['audio', 'video'], initiatorType) || /\\.(mp3|mp4)$/i.exec(path) !== null;\n}]];\nexport function computeResourceKind(timing) {\n  var url = timing.name;\n\n  if (!isValidUrl(url)) {\n    addMonitoringMessage(\"Failed to construct URL for \\\"\" + timing.name + \"\\\"\");\n    return ResourceType.OTHER;\n  }\n\n  var path = getPathName(url);\n\n  for (var _i = 0, RESOURCE_TYPES_1 = RESOURCE_TYPES; _i < RESOURCE_TYPES_1.length; _i++) {\n    var _a = RESOURCE_TYPES_1[_i],\n        type = _a[0],\n        isType = _a[1];\n\n    if (isType(timing.initiatorType, path)) {\n      return type;\n    }\n  }\n\n  return ResourceType.OTHER;\n}\n\nfunction areInOrder() {\n  var numbers = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    numbers[_i] = arguments[_i];\n  }\n\n  for (var i = 1; i < numbers.length; i += 1) {\n    if (numbers[i - 1] > numbers[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function isRequestKind(timing) {\n  return timing.initiatorType === 'xmlhttprequest' || timing.initiatorType === 'fetch';\n}\nexport function computePerformanceResourceDuration(entry) {\n  var duration = entry.duration,\n      startTime = entry.startTime,\n      responseEnd = entry.responseEnd; // Safari duration is always 0 on timings blocked by cross origin policies.\n\n  if (duration === 0 && startTime < responseEnd) {\n    return toServerDuration(elapsed(startTime, responseEnd));\n  }\n\n  return toServerDuration(duration);\n}\nexport function computePerformanceResourceDetails(entry) {\n  var validEntry = toValidEntry(entry);\n\n  if (!validEntry) {\n    return undefined;\n  }\n\n  var startTime = validEntry.startTime,\n      fetchStart = validEntry.fetchStart,\n      redirectStart = validEntry.redirectStart,\n      redirectEnd = validEntry.redirectEnd,\n      domainLookupStart = validEntry.domainLookupStart,\n      domainLookupEnd = validEntry.domainLookupEnd,\n      connectStart = validEntry.connectStart,\n      secureConnectionStart = validEntry.secureConnectionStart,\n      connectEnd = validEntry.connectEnd,\n      requestStart = validEntry.requestStart,\n      responseStart = validEntry.responseStart,\n      responseEnd = validEntry.responseEnd;\n  var details = {\n    download: formatTiming(startTime, responseStart, responseEnd),\n    first_byte: formatTiming(startTime, requestStart, responseStart)\n  }; // Make sure a connection occurred\n\n  if (connectEnd !== fetchStart) {\n    details.connect = formatTiming(startTime, connectStart, connectEnd); // Make sure a secure connection occurred\n\n    if (areInOrder(connectStart, secureConnectionStart, connectEnd)) {\n      details.ssl = formatTiming(startTime, secureConnectionStart, connectEnd);\n    }\n  } // Make sure a domain lookup occurred\n\n\n  if (domainLookupEnd !== fetchStart) {\n    details.dns = formatTiming(startTime, domainLookupStart, domainLookupEnd);\n  }\n\n  if (hasRedirection(entry)) {\n    details.redirect = formatTiming(startTime, redirectStart, redirectEnd);\n  }\n\n  return details;\n}\nexport function toValidEntry(entry) {\n  // Ensure timings are in the right order. On top of filtering out potential invalid\n  // RumPerformanceResourceTiming, it will ignore entries from requests where timings cannot be\n  // collected, for example cross origin requests without a \"Timing-Allow-Origin\" header allowing\n  // it.\n  if (!areInOrder(entry.startTime, entry.fetchStart, entry.domainLookupStart, entry.domainLookupEnd, entry.connectStart, entry.connectEnd, entry.requestStart, entry.responseStart, entry.responseEnd)) {\n    return undefined;\n  }\n\n  if (!hasRedirection(entry)) {\n    return entry;\n  }\n\n  var redirectStart = entry.redirectStart,\n      redirectEnd = entry.redirectEnd; // Firefox doesn't provide redirect timings on cross origin requests.\n  // Provide a default for those.\n\n  if (redirectStart < entry.startTime) {\n    redirectStart = entry.startTime;\n  }\n\n  if (redirectEnd < entry.startTime) {\n    redirectEnd = entry.fetchStart;\n  } // Make sure redirect timings are in order\n\n\n  if (!areInOrder(entry.startTime, redirectStart, redirectEnd, entry.fetchStart)) {\n    return undefined;\n  }\n\n  return __assign(__assign({}, entry), {\n    redirectEnd: redirectEnd,\n    redirectStart: redirectStart\n  });\n}\n\nfunction hasRedirection(entry) {\n  // The only time fetchStart is different than startTime is if a redirection occurred.\n  return entry.fetchStart !== entry.startTime;\n}\n\nfunction formatTiming(origin, start, end) {\n  return {\n    duration: toServerDuration(elapsed(start, end)),\n    start: toServerDuration(elapsed(origin, start))\n  };\n}\n\nexport function computeSize(entry) {\n  // Make sure a request actually occurred\n  if (entry.startTime < entry.responseStart) {\n    return entry.decodedBodySize;\n  }\n\n  return undefined;\n}\nexport function isAllowedRequestUrl(configuration, url) {\n  return url && !configuration.isIntakeUrl(url);\n}","import { findCommaSeparatedValue, ONE_MINUTE } from '@datadog/browser-core';\nexport var INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD = 2 * ONE_MINUTE;\nexport function getDocumentTraceId(document) {\n  var data = getDocumentTraceDataFromMeta(document) || getDocumentTraceDataFromComment(document);\n\n  if (!data || data.traceTime <= Date.now() - INITIAL_DOCUMENT_OUTDATED_TRACE_ID_THRESHOLD) {\n    return undefined;\n  }\n\n  return data.traceId;\n}\nexport function getDocumentTraceDataFromMeta(document) {\n  var traceIdMeta = document.querySelector('meta[name=dd-trace-id]');\n  var traceTimeMeta = document.querySelector('meta[name=dd-trace-time]');\n  return createDocumentTraceData(traceIdMeta && traceIdMeta.content, traceTimeMeta && traceTimeMeta.content);\n}\nexport function getDocumentTraceDataFromComment(document) {\n  var comment = findTraceComment(document);\n\n  if (!comment) {\n    return undefined;\n  }\n\n  return createDocumentTraceData(findCommaSeparatedValue(comment, 'trace-id'), findCommaSeparatedValue(comment, 'trace-time'));\n}\nexport function createDocumentTraceData(traceId, rawTraceTime) {\n  var traceTime = rawTraceTime && Number(rawTraceTime);\n\n  if (!traceId || !traceTime) {\n    return undefined;\n  }\n\n  return {\n    traceId: traceId,\n    traceTime: traceTime\n  };\n}\nexport function findTraceComment(document) {\n  // 1. Try to find the comment as a direct child of the document\n  // Note: TSLint advises to use a 'for of', but TS doesn't allow to use 'for of' if the iterated\n  // value is not an array or string (here, a NodeList).\n  // eslint-disable-next-line @typescript-eslint/prefer-for-of\n  for (var i = 0; i < document.childNodes.length; i += 1) {\n    var comment = getTraceCommentFromNode(document.childNodes[i]);\n\n    if (comment) {\n      return comment;\n    }\n  } // 2. If the comment is placed after the </html> tag, but have some space or new lines before or\n  // after, the DOM parser will lift it (and the surrounding text) at the end of the <body> tag.\n  // Try to look for the comment at the end of the <body> by by iterating over its child nodes in\n  // reverse order, stopping if we come across a non-text node.\n\n\n  if (document.body) {\n    for (var i = document.body.childNodes.length - 1; i >= 0; i -= 1) {\n      var node = document.body.childNodes[i];\n      var comment = getTraceCommentFromNode(node);\n\n      if (comment) {\n        return comment;\n      }\n\n      if (!isTextNode(node)) {\n        break;\n      }\n    }\n  }\n}\n\nfunction getTraceCommentFromNode(node) {\n  if (node && isCommentNode(node)) {\n    var match = /^\\s*DATADOG;(.*?)\\s*$/.exec(node.data);\n\n    if (match) {\n      return match[1];\n    }\n  }\n}\n\nfunction isCommentNode(node) {\n  return node.nodeName === '#comment';\n}\n\nfunction isTextNode(node) {\n  return node.nodeName === '#text';\n}","import { __assign } from \"tslib\";\nimport { addEventListeners, getRelativeTime, isNumber, monitor, relativeNow, runOnReadyState } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../domain/lifeCycle';\nimport { FAKE_INITIAL_DOCUMENT, isAllowedRequestUrl } from '../domain/rumEventsCollection/resource/resourceUtils';\nimport { getDocumentTraceId } from '../domain/tracing/getDocumentTraceId';\n\nfunction supportPerformanceObject() {\n  return window.performance !== undefined && 'getEntries' in performance;\n}\n\nexport function supportPerformanceTimingEvent(entryType) {\n  return window.PerformanceObserver && PerformanceObserver.supportedEntryTypes !== undefined && PerformanceObserver.supportedEntryTypes.includes(entryType);\n}\nexport function startPerformanceCollection(lifeCycle, configuration) {\n  retrieveInitialDocumentResourceTiming(function (timing) {\n    handleRumPerformanceEntry(lifeCycle, configuration, timing);\n  });\n\n  if (supportPerformanceObject()) {\n    handlePerformanceEntries(lifeCycle, configuration, performance.getEntries());\n  }\n\n  if (window.PerformanceObserver) {\n    var observer = new PerformanceObserver(monitor(function (entries) {\n      return handlePerformanceEntries(lifeCycle, configuration, entries.getEntries());\n    }));\n    var entryTypes = ['resource', 'navigation', 'longtask', 'paint', 'largest-contentful-paint', 'first-input', 'layout-shift'];\n    observer.observe({\n      entryTypes: entryTypes\n    });\n\n    if (supportPerformanceObject() && 'addEventListener' in performance) {\n      // https://bugzilla.mozilla.org/show_bug.cgi?id=1559377\n      performance.addEventListener('resourcetimingbufferfull', function () {\n        performance.clearResourceTimings();\n      });\n    }\n  }\n\n  if (!supportPerformanceTimingEvent('navigation')) {\n    retrieveNavigationTiming(function (timing) {\n      handleRumPerformanceEntry(lifeCycle, configuration, timing);\n    });\n  }\n\n  if (!supportPerformanceTimingEvent('first-input')) {\n    retrieveFirstInputTiming(function (timing) {\n      handleRumPerformanceEntry(lifeCycle, configuration, timing);\n    });\n  }\n}\nexport function retrieveInitialDocumentResourceTiming(callback) {\n  runOnReadyState('interactive', function () {\n    var timing;\n    var forcedAttributes = {\n      entryType: 'resource',\n      initiatorType: FAKE_INITIAL_DOCUMENT,\n      traceId: getDocumentTraceId(document)\n    };\n\n    if (supportPerformanceTimingEvent('navigation') && performance.getEntriesByType('navigation').length > 0) {\n      var navigationEntry = performance.getEntriesByType('navigation')[0];\n      timing = __assign(__assign({}, navigationEntry.toJSON()), forcedAttributes);\n    } else {\n      var relativePerformanceTiming = computeRelativePerformanceTiming();\n      timing = __assign(__assign(__assign({}, relativePerformanceTiming), {\n        decodedBodySize: 0,\n        duration: relativePerformanceTiming.responseEnd,\n        name: window.location.href,\n        startTime: 0\n      }), forcedAttributes);\n    }\n\n    callback(timing);\n  });\n}\n\nfunction retrieveNavigationTiming(callback) {\n  function sendFakeTiming() {\n    callback(__assign(__assign({}, computeRelativePerformanceTiming()), {\n      entryType: 'navigation'\n    }));\n  }\n\n  runOnReadyState('complete', function () {\n    // Send it a bit after the actual load event, so the \"loadEventEnd\" timing is accurate\n    setTimeout(monitor(sendFakeTiming));\n  });\n}\n/**\n * first-input timing entry polyfill based on\n * https://github.com/GoogleChrome/web-vitals/blob/master/src/lib/polyfills/firstInputPolyfill.ts\n */\n\n\nfunction retrieveFirstInputTiming(callback) {\n  var startTimeStamp = Date.now();\n  var timingSent = false;\n  var removeEventListeners = addEventListeners(window, [\"click\"\n  /* CLICK */\n  , \"mousedown\"\n  /* MOUSE_DOWN */\n  , \"keydown\"\n  /* KEY_DOWN */\n  , \"touchstart\"\n  /* TOUCH_START */\n  , \"pointerdown\"\n  /* POINTER_DOWN */\n  ], function (evt) {\n    // Only count cancelable events, which should trigger behavior important to the user.\n    if (!evt.cancelable) {\n      return;\n    } // This timing will be used to compute the \"first Input delay\", which is the delta between\n    // when the system received the event (e.g. evt.timeStamp) and when it could run the callback\n    // (e.g. performance.now()).\n\n\n    var timing = {\n      entryType: 'first-input',\n      processingStart: relativeNow(),\n      startTime: evt.timeStamp,\n      name: \"emulated \" + evt.type\n    };\n\n    if (evt.type === \"pointerdown\"\n    /* POINTER_DOWN */\n    ) {\n        sendTimingIfPointerIsNotCancelled(timing);\n      } else {\n      sendTiming(timing);\n    }\n  }, {\n    passive: true,\n    capture: true\n  }).stop;\n  /**\n   * Pointer events are a special case, because they can trigger main or compositor thread behavior.\n   * We differentiate these cases based on whether or not we see a pointercancel event, which are\n   * fired when we scroll. If we're scrolling we don't need to report input delay since FID excludes\n   * scrolling and pinch/zooming.\n   */\n\n  function sendTimingIfPointerIsNotCancelled(timing) {\n    addEventListeners(window, [\"pointerup\"\n    /* POINTER_UP */\n    , \"pointercancel\"\n    /* POINTER_CANCEL */\n    ], function (event) {\n      if (event.type === \"pointerup\"\n      /* POINTER_UP */\n      ) {\n          sendTiming(timing);\n        }\n    }, {\n      once: true\n    });\n  }\n\n  function sendTiming(timing) {\n    if (!timingSent) {\n      timingSent = true;\n      removeEventListeners(); // In some cases the recorded delay is clearly wrong, e.g. it's negative or it's larger than\n      // the time between now and when the page was loaded.\n      // - https://github.com/GoogleChromeLabs/first-input-delay/issues/4\n      // - https://github.com/GoogleChromeLabs/first-input-delay/issues/6\n      // - https://github.com/GoogleChromeLabs/first-input-delay/issues/7\n\n      var delay = timing.processingStart - timing.startTime;\n\n      if (delay >= 0 && delay < Date.now() - startTimeStamp) {\n        callback(timing);\n      }\n    }\n  }\n}\n\nfunction computeRelativePerformanceTiming() {\n  var result = {};\n  var timing = performance.timing;\n\n  for (var key in timing) {\n    if (isNumber(timing[key])) {\n      var numberKey = key; // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n\n      var timingElement = timing[numberKey];\n      result[numberKey] = timingElement === 0 ? 0 : getRelativeTime(timingElement);\n    }\n  }\n\n  return result;\n}\n\nfunction handlePerformanceEntries(lifeCycle, configuration, entries) {\n  entries.forEach(function (entry) {\n    if (entry.entryType === 'resource' || entry.entryType === 'navigation' || entry.entryType === 'paint' || entry.entryType === 'longtask' || entry.entryType === 'largest-contentful-paint' || entry.entryType === 'first-input' || entry.entryType === 'layout-shift') {\n      handleRumPerformanceEntry(lifeCycle, configuration, entry);\n    }\n  });\n}\n\nfunction handleRumPerformanceEntry(lifeCycle, configuration, entry) {\n  if (isIncompleteNavigation(entry) || isForbiddenResource(configuration, entry)) {\n    return;\n  }\n\n  lifeCycle.notify(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, entry);\n}\n\nfunction isIncompleteNavigation(entry) {\n  return entry.entryType === 'navigation' && entry.loadEventEnd <= 0;\n}\n\nfunction isForbiddenResource(configuration, entry) {\n  return entry.entryType === 'resource' && !isAllowedRequestUrl(configuration, entry.name);\n}","import { combine, isEmptyObject, limitModification, timeStampNow } from '@datadog/browser-core';\nimport { RumEventType } from '../rawRumEvent.types';\nimport { LifeCycleEventType } from './lifeCycle';\nvar SessionType;\n\n(function (SessionType) {\n  SessionType[\"SYNTHETICS\"] = \"synthetics\";\n  SessionType[\"USER\"] = \"user\";\n})(SessionType || (SessionType = {}));\n\nvar FIELDS_WITH_SENSITIVE_DATA = ['view.url', 'view.referrer', 'action.target.name', 'error.message', 'error.stack', 'error.resource.url', 'resource.url'];\nexport function startRumAssembly(applicationId, configuration, lifeCycle, session, parentContexts, getCommonContext) {\n  lifeCycle.subscribe(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, function (_a) {\n    var startTime = _a.startTime,\n        rawRumEvent = _a.rawRumEvent,\n        savedCommonContext = _a.savedCommonContext,\n        customerContext = _a.customerContext;\n    var viewContext = parentContexts.findView(startTime);\n\n    if (session.isTracked() && viewContext && viewContext.session.id) {\n      var actionContext = parentContexts.findAction(startTime);\n      var commonContext = savedCommonContext || getCommonContext();\n      var rumContext = {\n        _dd: {\n          format_version: 2\n        },\n        application: {\n          id: applicationId\n        },\n        date: timeStampNow(),\n        service: configuration.service,\n        session: {\n          has_replay: commonContext.hasReplay,\n          // must be computed on each event because synthetics instrumentation can be done after sdk execution\n          // cf https://github.com/puppeteer/puppeteer/issues/3667\n          type: getSessionType()\n        }\n      };\n      var serverRumEvent = needToAssembleWithAction(rawRumEvent) ? combine(rumContext, viewContext, actionContext, rawRumEvent) : combine(rumContext, viewContext, rawRumEvent);\n      var context = combine(commonContext.context, customerContext);\n\n      if (!isEmptyObject(context)) {\n        serverRumEvent.context = context;\n      }\n\n      if (!isEmptyObject(commonContext.user)) {\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-type-assertion\n        ;\n        serverRumEvent.usr = commonContext.user;\n      }\n\n      if (shouldSend(serverRumEvent, configuration.beforeSend)) {\n        lifeCycle.notify(LifeCycleEventType.RUM_EVENT_COLLECTED, serverRumEvent);\n      }\n    }\n  });\n}\n\nfunction shouldSend(event, beforeSend) {\n  if (beforeSend) {\n    var result = limitModification(event, FIELDS_WITH_SENSITIVE_DATA, beforeSend);\n\n    if (result === false && event.type !== RumEventType.VIEW) {\n      return false;\n    }\n\n    if (result === false) {\n      console.warn(\"Can't dismiss view events using beforeSend, use onNewLocation instead!\");\n    }\n  }\n\n  return true;\n}\n\nfunction needToAssembleWithAction(event) {\n  return [RumEventType.ERROR, RumEventType.RESOURCE, RumEventType.LONG_TASK].indexOf(event.type) !== -1;\n}\n\nfunction getSessionType() {\n  // eslint-disable-next-line no-underscore-dangle\n  return window._DATADOG_SYNTHETICS_BROWSER === undefined ? SessionType.USER : SessionType.SYNTHETICS;\n}","import { monitor, ONE_MINUTE, SESSION_TIME_OUT_DELAY } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\nexport var VIEW_CONTEXT_TIME_OUT_DELAY = SESSION_TIME_OUT_DELAY;\nexport var ACTION_CONTEXT_TIME_OUT_DELAY = 5 * ONE_MINUTE; // arbitrary\n\nexport var CLEAR_OLD_CONTEXTS_INTERVAL = ONE_MINUTE;\nexport function startParentContexts(lifeCycle, session) {\n  var currentView;\n  var currentAction;\n  var currentSessionId;\n  var previousViews = [];\n  var previousActions = [];\n  lifeCycle.subscribe(LifeCycleEventType.VIEW_CREATED, function (currentContext) {\n    if (currentView) {\n      previousViews.unshift({\n        context: buildCurrentViewContext(),\n        endTime: currentContext.startTime,\n        startTime: currentView.startTime\n      });\n    }\n\n    currentView = currentContext;\n    currentSessionId = session.getId();\n  });\n  lifeCycle.subscribe(LifeCycleEventType.VIEW_UPDATED, function (currentContext) {\n    // A view can be updated after its end.  We have to ensure that the view being updated is the\n    // most recently created.\n    if (currentView.id === currentContext.id) {\n      currentView = currentContext;\n    }\n  });\n  lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_CREATED, function (currentContext) {\n    currentAction = currentContext;\n  });\n  lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_COMPLETED, function (action) {\n    if (currentAction) {\n      previousActions.unshift({\n        context: buildCurrentActionContext(),\n        // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n        endTime: currentAction.startTime + action.duration,\n        startTime: currentAction.startTime\n      });\n    }\n\n    currentAction = undefined;\n  });\n  lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_DISCARDED, function () {\n    currentAction = undefined;\n  });\n  lifeCycle.subscribe(LifeCycleEventType.SESSION_RENEWED, function () {\n    previousViews = [];\n    previousActions = [];\n    currentView = undefined;\n    currentAction = undefined;\n  });\n  var clearOldContextsInterval = setInterval(monitor(function () {\n    clearOldContexts(previousViews, VIEW_CONTEXT_TIME_OUT_DELAY);\n    clearOldContexts(previousActions, ACTION_CONTEXT_TIME_OUT_DELAY);\n  }), CLEAR_OLD_CONTEXTS_INTERVAL);\n\n  function clearOldContexts(previousContexts, timeOutDelay) {\n    var oldTimeThreshold = performance.now() - timeOutDelay;\n\n    while (previousContexts.length > 0 && previousContexts[previousContexts.length - 1].startTime < oldTimeThreshold) {\n      previousContexts.pop();\n    }\n  }\n\n  function buildCurrentViewContext() {\n    return {\n      session: {\n        id: currentSessionId\n      },\n      view: {\n        id: currentView.id,\n        name: currentView.name,\n        referrer: currentView.referrer,\n        url: currentView.location.href\n      }\n    };\n  }\n\n  function buildCurrentActionContext() {\n    return {\n      action: {\n        id: currentAction.id\n      }\n    };\n  }\n\n  function findContext(buildContext, previousContexts, currentContext, startTime) {\n    if (startTime === undefined) {\n      return currentContext ? buildContext() : undefined;\n    }\n\n    if (currentContext && startTime >= currentContext.startTime) {\n      return buildContext();\n    }\n\n    for (var _i = 0, previousContexts_1 = previousContexts; _i < previousContexts_1.length; _i++) {\n      var previousContext = previousContexts_1[_i];\n\n      if (startTime > previousContext.endTime) {\n        break;\n      }\n\n      if (startTime >= previousContext.startTime) {\n        return previousContext.context;\n      }\n    }\n\n    return undefined;\n  }\n\n  return {\n    findAction: function findAction(startTime) {\n      return findContext(buildCurrentActionContext, previousActions, currentAction, startTime);\n    },\n    findView: function findView(startTime) {\n      return findContext(buildCurrentViewContext, previousViews, currentView, startTime);\n    },\n    stop: function stop() {\n      clearInterval(clearOldContextsInterval);\n    }\n  };\n}","import { __assign } from \"tslib\";\nimport { getOrigin, objectEntries } from '@datadog/browser-core';\nexport function clearTracingIfCancelled(context) {\n  if (context.status === 0) {\n    context.traceId = undefined;\n    context.spanId = undefined;\n  }\n}\nexport function startTracer(configuration) {\n  return {\n    clearTracingIfCancelled: clearTracingIfCancelled,\n    traceFetch: function traceFetch(context) {\n      return injectHeadersIfTracingAllowed(configuration, context, function (tracingHeaders) {\n        var _a;\n\n        if (context.input instanceof Request && !((_a = context.init) === null || _a === void 0 ? void 0 : _a.headers)) {\n          context.input = new Request(context.input);\n          Object.keys(tracingHeaders).forEach(function (key) {\n            ;\n            context.input.headers.append(key, tracingHeaders[key]);\n          });\n        } else {\n          context.init = __assign({}, context.init);\n          var headers_1 = [];\n\n          if (context.init.headers instanceof Headers) {\n            context.init.headers.forEach(function (value, key) {\n              headers_1.push([key, value]);\n            });\n          } else if (Array.isArray(context.init.headers)) {\n            context.init.headers.forEach(function (header) {\n              headers_1.push(header);\n            });\n          } else if (context.init.headers) {\n            Object.keys(context.init.headers).forEach(function (key) {\n              headers_1.push([key, context.init.headers[key]]);\n            });\n          }\n\n          context.init.headers = headers_1.concat(objectEntries(tracingHeaders));\n        }\n      });\n    },\n    traceXhr: function traceXhr(context, xhr) {\n      return injectHeadersIfTracingAllowed(configuration, context, function (tracingHeaders) {\n        Object.keys(tracingHeaders).forEach(function (name) {\n          xhr.setRequestHeader(name, tracingHeaders[name]);\n        });\n      });\n    }\n  };\n}\n\nfunction injectHeadersIfTracingAllowed(configuration, context, inject) {\n  if (!isTracingSupported() || !isAllowedUrl(configuration, context.url)) {\n    return;\n  }\n\n  context.traceId = new TraceIdentifier();\n  context.spanId = new TraceIdentifier();\n  inject(makeTracingHeaders(context.traceId, context.spanId));\n}\n\nfunction isAllowedUrl(configuration, requestUrl) {\n  var requestOrigin = getOrigin(requestUrl);\n\n  for (var _i = 0, _a = configuration.allowedTracingOrigins; _i < _a.length; _i++) {\n    var allowedOrigin = _a[_i];\n\n    if (requestOrigin === allowedOrigin || allowedOrigin instanceof RegExp && allowedOrigin.test(requestOrigin)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function isTracingSupported() {\n  return getCrypto() !== undefined;\n}\n\nfunction getCrypto() {\n  return window.crypto || window.msCrypto;\n}\n\nfunction makeTracingHeaders(traceId, spanId) {\n  return {\n    'x-datadog-origin': 'rum',\n    'x-datadog-parent-id': spanId.toDecimalString(),\n    'x-datadog-sampled': '1',\n    'x-datadog-sampling-priority': '1',\n    'x-datadog-trace-id': traceId.toDecimalString()\n  };\n}\n/* eslint-disable no-bitwise */\n\n\nvar TraceIdentifier =\n/** @class */\nfunction () {\n  function TraceIdentifier() {\n    this.buffer = new Uint8Array(8);\n    getCrypto().getRandomValues(this.buffer);\n    this.buffer[0] = this.buffer[0] & 0x7f; // force 63-bit\n  }\n\n  TraceIdentifier.prototype.toString = function (radix) {\n    var high = this.readInt32(0);\n    var low = this.readInt32(4);\n    var str = '';\n\n    while (1) {\n      var mod = high % radix * 4294967296 + low;\n      high = Math.floor(high / radix);\n      low = Math.floor(mod / radix);\n      str = (mod % radix).toString(radix) + str;\n\n      if (!high && !low) {\n        break;\n      }\n    }\n\n    return str;\n  };\n  /**\n   * Format used everywhere except the trace intake\n   */\n\n\n  TraceIdentifier.prototype.toDecimalString = function () {\n    return this.toString(10);\n  };\n\n  TraceIdentifier.prototype.readInt32 = function (offset) {\n    return this.buffer[offset] * 16777216 + (this.buffer[offset + 1] << 16) + (this.buffer[offset + 2] << 8) + this.buffer[offset + 3];\n  };\n\n  return TraceIdentifier;\n}();\n\nexport { TraceIdentifier };\n/* eslint-enable no-bitwise */","import { RequestType, startFetchProxy, startXhrProxy } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\nimport { isAllowedRequestUrl } from './rumEventsCollection/resource/resourceUtils';\nimport { startTracer } from './tracing/tracer';\nvar nextRequestIndex = 1;\nexport function startRequestCollection(lifeCycle, configuration) {\n  var tracer = startTracer(configuration);\n  trackXhr(lifeCycle, configuration, tracer);\n  trackFetch(lifeCycle, configuration, tracer);\n}\nexport function trackXhr(lifeCycle, configuration, tracer) {\n  var xhrProxy = startXhrProxy();\n  xhrProxy.beforeSend(function (context, xhr) {\n    if (isAllowedRequestUrl(configuration, context.url)) {\n      tracer.traceXhr(context, xhr);\n      context.requestIndex = getNextRequestIndex();\n      lifeCycle.notify(LifeCycleEventType.REQUEST_STARTED, {\n        requestIndex: context.requestIndex\n      });\n    }\n  });\n  xhrProxy.onRequestComplete(function (context) {\n    if (isAllowedRequestUrl(configuration, context.url)) {\n      tracer.clearTracingIfCancelled(context);\n      lifeCycle.notify(LifeCycleEventType.REQUEST_COMPLETED, {\n        duration: context.duration,\n        method: context.method,\n        requestIndex: context.requestIndex,\n        response: context.response,\n        spanId: context.spanId,\n        startTime: context.startTime,\n        status: context.status,\n        traceId: context.traceId,\n        type: RequestType.XHR,\n        url: context.url\n      });\n    }\n  });\n  return xhrProxy;\n}\nexport function trackFetch(lifeCycle, configuration, tracer) {\n  var fetchProxy = startFetchProxy();\n  fetchProxy.beforeSend(function (context) {\n    if (isAllowedRequestUrl(configuration, context.url)) {\n      tracer.traceFetch(context);\n      context.requestIndex = getNextRequestIndex();\n      lifeCycle.notify(LifeCycleEventType.REQUEST_STARTED, {\n        requestIndex: context.requestIndex\n      });\n    }\n  });\n  fetchProxy.onRequestComplete(function (context) {\n    if (isAllowedRequestUrl(configuration, context.url)) {\n      tracer.clearTracingIfCancelled(context);\n      lifeCycle.notify(LifeCycleEventType.REQUEST_COMPLETED, {\n        duration: context.duration,\n        method: context.method,\n        requestIndex: context.requestIndex,\n        response: context.response,\n        responseType: context.responseType,\n        spanId: context.spanId,\n        startTime: context.startTime,\n        status: context.status,\n        traceId: context.traceId,\n        type: RequestType.FETCH,\n        url: context.url\n      });\n    }\n  });\n  return fetchProxy;\n}\n\nfunction getNextRequestIndex() {\n  var result = nextRequestIndex;\n  nextRequestIndex += 1;\n  return result;\n}","import { noop } from '@datadog/browser-core';\nimport { RumEventType } from '../rawRumEvent.types';\nimport { LifeCycleEventType } from './lifeCycle';\nexport function trackEventCounts(lifeCycle, callback) {\n  if (callback === void 0) {\n    callback = noop;\n  }\n\n  var eventCounts = {\n    errorCount: 0,\n    longTaskCount: 0,\n    resourceCount: 0,\n    userActionCount: 0\n  };\n  var subscription = lifeCycle.subscribe(LifeCycleEventType.RUM_EVENT_COLLECTED, function (_a) {\n    var type = _a.type;\n\n    switch (type) {\n      case RumEventType.ERROR:\n        eventCounts.errorCount += 1;\n        callback(eventCounts);\n        break;\n\n      case RumEventType.ACTION:\n        eventCounts.userActionCount += 1;\n        callback(eventCounts);\n        break;\n\n      case RumEventType.LONG_TASK:\n        eventCounts.longTaskCount += 1;\n        callback(eventCounts);\n        break;\n\n      case RumEventType.RESOURCE:\n        eventCounts.resourceCount += 1;\n        callback(eventCounts);\n        break;\n    }\n  });\n  return {\n    stop: function stop() {\n      subscription.unsubscribe();\n    },\n    eventCounts: eventCounts\n  };\n}","import { monitor, Observable, relativeNow } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle'; // Delay to wait for a page activity to validate the tracking process\n\nexport var PAGE_ACTIVITY_VALIDATION_DELAY = 100; // Delay to wait after a page activity to end the tracking process\n\nexport var PAGE_ACTIVITY_END_DELAY = 100; // Maximum duration of the tracking process\n\nexport var PAGE_ACTIVITY_MAX_DURATION = 10000;\nexport function waitIdlePageActivity(lifeCycle, completionCallback) {\n  var _a = trackPageActivities(lifeCycle),\n      pageActivitiesObservable = _a.observable,\n      stopPageActivitiesTracking = _a.stop;\n\n  var stopWaitPageActivitiesCompletion = waitPageActivitiesCompletion(pageActivitiesObservable, stopPageActivitiesTracking, completionCallback).stop;\n\n  var stop = function stop() {\n    stopWaitPageActivitiesCompletion();\n    stopPageActivitiesTracking();\n  };\n\n  return {\n    stop: stop\n  };\n} // Automatic action collection lifecycle overview:\n//                      (Start new trackPageActivities)\n//              .-------------------'--------------------.\n//              v                                        v\n//     [Wait for a page activity ]          [Wait for a maximum duration]\n//     [timeout: VALIDATION_DELAY]          [  timeout: MAX_DURATION    ]\n//          /                  \\                           |\n//         v                    v                          |\n//  [No page activity]   [Page activity]                   |\n//         |                   |,----------------------.   |\n//         v                   v                       |   |\n//     (Discard)     [Wait for a page activity]        |   |\n//                   [   timeout: END_DELAY   ]        |   |\n//                       /                \\            |   |\n//                      v                  v           |   |\n//             [No page activity]    [Page activity]   |   |\n//                      |                 |            |   |\n//                      |                 '------------'   |\n//                      '-----------. ,--------------------'\n//                                   v\n//                                 (End)\n//\n// Note: because MAX_DURATION > VALIDATION_DELAY, we are sure that if the process is still alive\n// after MAX_DURATION, it has been validated.\n\nexport function trackPageActivities(lifeCycle) {\n  var observable = new Observable();\n  var subscriptions = [];\n  var firstRequestIndex;\n  var pendingRequestsCount = 0;\n  subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.DOM_MUTATED, function () {\n    return notifyPageActivity();\n  }));\n  subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType !== 'resource') {\n      return;\n    }\n\n    notifyPageActivity();\n  }));\n  subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.REQUEST_STARTED, function (startEvent) {\n    if (firstRequestIndex === undefined) {\n      firstRequestIndex = startEvent.requestIndex;\n    }\n\n    pendingRequestsCount += 1;\n    notifyPageActivity();\n  }));\n  subscriptions.push(lifeCycle.subscribe(LifeCycleEventType.REQUEST_COMPLETED, function (request) {\n    // If the request started before the tracking start, ignore it\n    if (firstRequestIndex === undefined || request.requestIndex < firstRequestIndex) {\n      return;\n    }\n\n    pendingRequestsCount -= 1;\n    notifyPageActivity();\n  }));\n\n  function notifyPageActivity() {\n    observable.notify({\n      isBusy: pendingRequestsCount > 0\n    });\n  }\n\n  return {\n    observable: observable,\n    stop: function stop() {\n      subscriptions.forEach(function (s) {\n        return s.unsubscribe();\n      });\n    }\n  };\n}\nexport function waitPageActivitiesCompletion(pageActivitiesObservable, stopPageActivitiesTracking, completionCallback) {\n  var idleTimeoutId;\n  var hasCompleted = false;\n  var validationTimeoutId = setTimeout(monitor(function () {\n    return complete(false, 0);\n  }), PAGE_ACTIVITY_VALIDATION_DELAY);\n  var maxDurationTimeoutId = setTimeout(monitor(function () {\n    return complete(true, relativeNow());\n  }), PAGE_ACTIVITY_MAX_DURATION);\n  pageActivitiesObservable.subscribe(function (_a) {\n    var isBusy = _a.isBusy;\n    clearTimeout(validationTimeoutId);\n    clearTimeout(idleTimeoutId);\n    var lastChangeTime = relativeNow();\n\n    if (!isBusy) {\n      idleTimeoutId = setTimeout(monitor(function () {\n        return complete(true, lastChangeTime);\n      }), PAGE_ACTIVITY_END_DELAY);\n    }\n  });\n\n  var stop = function stop() {\n    hasCompleted = true;\n    clearTimeout(validationTimeoutId);\n    clearTimeout(idleTimeoutId);\n    clearTimeout(maxDurationTimeoutId);\n    stopPageActivitiesTracking();\n  };\n\n  function complete(hadActivity, endTime) {\n    if (hasCompleted) {\n      return;\n    }\n\n    stop();\n    completionCallback(hadActivity, endTime);\n  }\n\n  return {\n    stop: stop\n  };\n}","import { safeTruncate } from '@datadog/browser-core';\nexport function getActionNameFromElement(element) {\n  // Proceed to get the action name in two steps:\n  // * first, get the name programmatically, explicitly defined by the user.\n  // * then, use strategies that are known to return good results. Those strategies will be used on\n  //   the element and a few parents, but it's likely that they won't succeed at all.\n  // * if no name is found this way, use strategies returning less accurate names as a fallback.\n  //   Those are much likely to succeed.\n  return getActionNameFromElementProgrammatically(element) || getActionNameFromElementForStrategies(element, priorityStrategies) || getActionNameFromElementForStrategies(element, fallbackStrategies) || '';\n}\n/**\n * Get the action name from the attribute 'data-dd-action-name' on the element or any of its parent.\n */\n\nvar PROGRAMMATIC_ATTRIBUTE = 'data-dd-action-name';\n\nfunction getActionNameFromElementProgrammatically(targetElement) {\n  var elementWithAttribute; // We don't use getActionNameFromElementForStrategies here, because we want to consider all parents,\n  // without limit. It is up to the user to declare a relevant naming strategy.\n  // If available, use element.closest() to match get the attribute from the element or any of its\n  // parent.  Else fallback to a more traditional implementation.\n\n  if (supportsElementClosest()) {\n    elementWithAttribute = targetElement.closest(\"[\" + PROGRAMMATIC_ATTRIBUTE + \"]\");\n  } else {\n    var element = targetElement;\n\n    while (element) {\n      if (element.hasAttribute(PROGRAMMATIC_ATTRIBUTE)) {\n        elementWithAttribute = element;\n        break;\n      }\n\n      element = element.parentElement;\n    }\n  }\n\n  if (!elementWithAttribute) {\n    return;\n  }\n\n  var name = elementWithAttribute.getAttribute(PROGRAMMATIC_ATTRIBUTE);\n  return truncate(normalizeWhitespace(name.trim()));\n}\n\nvar priorityStrategies = [// associated LABEL text\nfunction (element) {\n  // IE does not support element.labels, so we fallback to a CSS selector based on the element id\n  // instead\n  if (supportsLabelProperty()) {\n    if ('labels' in element && element.labels && element.labels.length > 0) {\n      return getTextualContent(element.labels[0]);\n    }\n  } else if (element.id) {\n    var label = element.ownerDocument && element.ownerDocument.querySelector(\"label[for=\\\"\" + element.id.replace('\"', '\\\\\"') + \"\\\"]\");\n    return label && getTextualContent(label);\n  }\n}, // INPUT button (and associated) value\nfunction (element) {\n  if (element.nodeName === 'INPUT') {\n    var input = element;\n    var type = input.getAttribute('type');\n\n    if (type === 'button' || type === 'submit' || type === 'reset') {\n      return input.value;\n    }\n  }\n}, // BUTTON, LABEL or button-like element text\nfunction (element) {\n  if (element.nodeName === 'BUTTON' || element.nodeName === 'LABEL' || element.getAttribute('role') === 'button') {\n    return getTextualContent(element);\n  }\n}, function (element) {\n  return element.getAttribute('aria-label');\n}, // associated element text designated by the aria-labelledby attribute\nfunction (element) {\n  var labelledByAttribute = element.getAttribute('aria-labelledby');\n\n  if (labelledByAttribute) {\n    return labelledByAttribute.split(/\\s+/).map(function (id) {\n      return getElementById(element, id);\n    }).filter(function (label) {\n      return Boolean(label);\n    }).map(getTextualContent).join(' ');\n  }\n}, function (element) {\n  return element.getAttribute('alt');\n}, function (element) {\n  return element.getAttribute('name');\n}, function (element) {\n  return element.getAttribute('title');\n}, function (element) {\n  return element.getAttribute('placeholder');\n}, // SELECT first OPTION text\nfunction (element) {\n  if ('options' in element && element.options.length > 0) {\n    return getTextualContent(element.options[0]);\n  }\n}];\nvar fallbackStrategies = [function (element) {\n  return getTextualContent(element);\n}];\n/**\n * Iterates over the target element and its parent, using the strategies list to get an action name.\n * Each strategies are applied on each element, stopping as soon as a non-empty value is returned.\n */\n\nvar MAX_PARENTS_TO_CONSIDER = 10;\n\nfunction getActionNameFromElementForStrategies(targetElement, strategies) {\n  var element = targetElement;\n  var recursionCounter = 0;\n\n  while (recursionCounter <= MAX_PARENTS_TO_CONSIDER && element && element.nodeName !== 'BODY' && element.nodeName !== 'HTML' && element.nodeName !== 'HEAD') {\n    for (var _i = 0, strategies_1 = strategies; _i < strategies_1.length; _i++) {\n      var strategy = strategies_1[_i];\n      var name_1 = strategy(element);\n\n      if (typeof name_1 === 'string') {\n        var trimmedName = name_1.trim();\n\n        if (trimmedName) {\n          return truncate(normalizeWhitespace(trimmedName));\n        }\n      }\n    } // Consider a FORM as a contextual limit to get the action name.  This is experimental and may\n    // be reconsidered in the future.\n\n\n    if (element.nodeName === 'FORM') {\n      break;\n    }\n\n    element = element.parentElement;\n    recursionCounter += 1;\n  }\n}\n\nfunction normalizeWhitespace(s) {\n  return s.replace(/\\s+/g, ' ');\n}\n\nfunction truncate(s) {\n  return s.length > 100 ? safeTruncate(s, 100) + \" [...]\" : s;\n}\n\nfunction getElementById(refElement, id) {\n  // Use the element ownerDocument here, because tests are executed in an iframe, so\n  // document.getElementById won't work.\n  return refElement.ownerDocument ? refElement.ownerDocument.getElementById(id) : null;\n}\n\nfunction getTextualContent(element) {\n  if (element.isContentEditable) {\n    return;\n  }\n\n  if ('innerText' in element) {\n    var text = element.innerText;\n\n    if (!supportsInnerTextScriptAndStyleRemoval()) {\n      // remove the inner text of SCRIPT and STYLES from the result. This is a bit dirty, but should\n      // be relatively fast and work in most cases.\n      var elementsTextToRemove = element.querySelectorAll('script, style'); // eslint-disable-next-line @typescript-eslint/prefer-for-of\n\n      for (var i = 0; i < elementsTextToRemove.length; i += 1) {\n        var innerText = elementsTextToRemove[i].innerText;\n\n        if (innerText.trim().length > 0) {\n          text = text.replace(innerText, '');\n        }\n      }\n    }\n\n    return text;\n  }\n\n  return element.textContent;\n}\n/**\n * Returns true if element.innerText excludes the text from inline SCRIPT and STYLE element.  This\n * should be the case everywhere except on some version of Internet Explorer.\n * See http://perfectionkills.com/the-poor-misunderstood-innerText/#diff-with-textContent\n */\n\n\nvar supportsInnerTextScriptAndStyleRemovalResult;\n\nfunction supportsInnerTextScriptAndStyleRemoval() {\n  if (supportsInnerTextScriptAndStyleRemovalResult === undefined) {\n    var style = document.createElement('style');\n    style.textContent = '*';\n    var div = document.createElement('div');\n    div.appendChild(style);\n    document.body.appendChild(div);\n    supportsInnerTextScriptAndStyleRemovalResult = div.innerText === '';\n    document.body.removeChild(div);\n  }\n\n  return supportsInnerTextScriptAndStyleRemovalResult;\n}\n/**\n * Returns true if the browser supports the element.labels property.  This should be the case\n * everywhere except on Internet Explorer.\n * Note: The result is computed lazily, because we don't want any DOM access when the SDK is\n * evaluated.\n */\n\n\nvar supportsLabelPropertyResult;\n\nfunction supportsLabelProperty() {\n  if (supportsLabelPropertyResult === undefined) {\n    supportsLabelPropertyResult = 'labels' in HTMLInputElement.prototype;\n  }\n\n  return supportsLabelPropertyResult;\n}\n/**\n * Returns true if the browser supports the element.closest method.  This should be the case\n * everywhere except on Internet Explorer.\n * Note: The result is computed lazily, because we don't want any DOM access when the SDK is\n * evaluated.\n */\n\n\nvar supportsElementClosestResult;\n\nfunction supportsElementClosest() {\n  if (supportsElementClosestResult === undefined) {\n    supportsElementClosestResult = 'closest' in HTMLElement.prototype;\n  }\n\n  return supportsElementClosestResult;\n}","import { addEventListener, elapsed, generateUUID, relativeNow } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackEventCounts } from '../../trackEventCounts';\nimport { waitIdlePageActivity } from '../../trackPageActivities';\nimport { ActionType } from '../../../rawRumEvent.types';\nimport { getActionNameFromElement } from './getActionNameFromElement';\nexport function trackActions(lifeCycle) {\n  var action = startActionManagement(lifeCycle); // New views trigger the discard of the current pending Action\n\n  lifeCycle.subscribe(LifeCycleEventType.VIEW_CREATED, function () {\n    action.discardCurrent();\n  });\n  var stopListener = addEventListener(window, \"click\"\n  /* CLICK */\n  , function (event) {\n    if (!(event.target instanceof Element)) {\n      return;\n    }\n\n    var name = getActionNameFromElement(event.target);\n\n    if (!name) {\n      return;\n    }\n\n    action.create(ActionType.CLICK, name);\n  }, {\n    capture: true\n  }).stop;\n  return {\n    stop: function stop() {\n      action.discardCurrent();\n      stopListener();\n    }\n  };\n}\n\nfunction startActionManagement(lifeCycle) {\n  var currentAction;\n  var currentIdlePageActivitySubscription;\n  return {\n    create: function create(type, name) {\n      if (currentAction) {\n        // Ignore any new action if another one is already occurring.\n        return;\n      }\n\n      var pendingAutoAction = new PendingAutoAction(lifeCycle, type, name);\n      currentAction = pendingAutoAction;\n      currentIdlePageActivitySubscription = waitIdlePageActivity(lifeCycle, function (hadActivity, endTime) {\n        if (hadActivity) {\n          pendingAutoAction.complete(endTime);\n        } else {\n          pendingAutoAction.discard();\n        }\n\n        currentAction = undefined;\n      });\n    },\n    discardCurrent: function discardCurrent() {\n      if (currentAction) {\n        currentIdlePageActivitySubscription.stop();\n        currentAction.discard();\n        currentAction = undefined;\n      }\n    }\n  };\n}\n\nvar PendingAutoAction =\n/** @class */\nfunction () {\n  function PendingAutoAction(lifeCycle, type, name) {\n    this.lifeCycle = lifeCycle;\n    this.type = type;\n    this.name = name;\n    this.id = generateUUID();\n    this.startTime = relativeNow();\n    this.eventCountsSubscription = trackEventCounts(lifeCycle);\n    this.lifeCycle.notify(LifeCycleEventType.AUTO_ACTION_CREATED, {\n      id: this.id,\n      startTime: this.startTime\n    });\n  }\n\n  PendingAutoAction.prototype.complete = function (endTime) {\n    var eventCounts = this.eventCountsSubscription.eventCounts;\n    this.lifeCycle.notify(LifeCycleEventType.AUTO_ACTION_COMPLETED, {\n      counts: {\n        errorCount: eventCounts.errorCount,\n        longTaskCount: eventCounts.longTaskCount,\n        resourceCount: eventCounts.resourceCount\n      },\n      duration: elapsed(this.startTime, endTime),\n      id: this.id,\n      name: this.name,\n      startTime: this.startTime,\n      type: this.type\n    });\n    this.eventCountsSubscription.stop();\n  };\n\n  PendingAutoAction.prototype.discard = function () {\n    this.lifeCycle.notify(LifeCycleEventType.AUTO_ACTION_DISCARDED);\n    this.eventCountsSubscription.stop();\n  };\n\n  return PendingAutoAction;\n}();","import { __assign } from \"tslib\";\nimport { combine, getTimeStamp, toServerDuration } from '@datadog/browser-core';\nimport { ActionType, RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackActions } from './trackActions';\nexport function startActionCollection(lifeCycle, configuration) {\n  lifeCycle.subscribe(LifeCycleEventType.AUTO_ACTION_COMPLETED, function (action) {\n    return lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processAction(action));\n  });\n\n  if (configuration.trackInteractions) {\n    trackActions(lifeCycle);\n  }\n\n  return {\n    addAction: function addAction(action, savedCommonContext) {\n      lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, __assign({\n        savedCommonContext: savedCommonContext\n      }, processAction(action)));\n    }\n  };\n}\n\nfunction processAction(action) {\n  var autoActionProperties = isAutoAction(action) ? {\n    action: {\n      error: {\n        count: action.counts.errorCount\n      },\n      id: action.id,\n      loading_time: toServerDuration(action.duration),\n      long_task: {\n        count: action.counts.longTaskCount\n      },\n      resource: {\n        count: action.counts.resourceCount\n      }\n    }\n  } : undefined;\n  var customerContext = !isAutoAction(action) ? action.context : undefined;\n  var actionEvent = combine({\n    action: {\n      target: {\n        name: action.name\n      },\n      type: action.type\n    },\n    date: getTimeStamp(action.startTime),\n    type: RumEventType.ACTION\n  }, autoActionProperties);\n  return {\n    customerContext: customerContext,\n    rawRumEvent: actionEvent,\n    startTime: action.startTime\n  };\n}\n\nfunction isAutoAction(action) {\n  return action.type !== ActionType.CUSTOM;\n}","import { addEventListener } from '@datadog/browser-core';\nvar trackFirstHiddenSingleton;\nvar stopListeners;\nexport function trackFirstHidden(emitter) {\n  if (emitter === void 0) {\n    emitter = window;\n  }\n\n  if (!trackFirstHiddenSingleton) {\n    if (document.visibilityState === 'hidden') {\n      trackFirstHiddenSingleton = {\n        timeStamp: 0\n      };\n    } else {\n      trackFirstHiddenSingleton = {\n        timeStamp: Infinity\n      };\n      stopListeners = addEventListener(emitter, \"pagehide\"\n      /* PAGE_HIDE */\n      , function (_a) {\n        var timeStamp = _a.timeStamp;\n        trackFirstHiddenSingleton.timeStamp = timeStamp;\n      }, {\n        capture: true,\n        once: true\n      }).stop;\n    }\n  }\n\n  return trackFirstHiddenSingleton;\n}\nexport function resetFirstHidden() {\n  if (stopListeners) {\n    stopListeners();\n  }\n\n  trackFirstHiddenSingleton = undefined;\n}","import { __assign } from \"tslib\";\nimport { computeStackTrace, formatUnknownError, getTimeStamp, startAutomaticErrorCollection } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nexport function startErrorCollection(lifeCycle, configuration) {\n  return doStartErrorCollection(lifeCycle, startAutomaticErrorCollection(configuration));\n}\nexport function doStartErrorCollection(lifeCycle, observable) {\n  observable.subscribe(function (error) {\n    return lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processError(error));\n  });\n  return {\n    addError: function addError(_a, savedCommonContext) {\n      var error = _a.error,\n          startTime = _a.startTime,\n          customerContext = _a.context,\n          source = _a.source;\n      var rawError = computeRawError(error, startTime, source);\n      lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, __assign({\n        customerContext: customerContext,\n        savedCommonContext: savedCommonContext\n      }, processError(rawError)));\n    }\n  };\n}\n\nfunction computeRawError(error, startTime, source) {\n  var stackTrace = error instanceof Error ? computeStackTrace(error) : undefined;\n  return __assign({\n    startTime: startTime,\n    source: source\n  }, formatUnknownError(stackTrace, error, 'Provided'));\n}\n\nfunction processError(error) {\n  var rawRumEvent = {\n    date: getTimeStamp(error.startTime),\n    error: {\n      message: error.message,\n      resource: error.resource ? {\n        method: error.resource.method,\n        status_code: error.resource.statusCode,\n        url: error.resource.url\n      } : undefined,\n      source: error.source,\n      stack: error.stack,\n      type: error.type\n    },\n    type: RumEventType.ERROR\n  };\n  return {\n    rawRumEvent: rawRumEvent,\n    startTime: error.startTime\n  };\n}","import { toValidEntry } from './resourceUtils';\n/**\n * Look for corresponding timing in resource timing buffer\n *\n * Observations:\n * - Timing (start, end) are nested inside the request (start, end)\n * - Browsers generate a timing entry for OPTIONS request\n *\n * Strategy:\n * - from valid nested entries\n * - if a single timing match, return the timing\n * - if two following timings match (OPTIONS request), return the timing for the actual request\n * - otherwise we can't decide, return undefined\n */\n\nexport function matchRequestTiming(request) {\n  if (!performance || !('getEntriesByName' in performance)) {\n    return;\n  }\n\n  var sameNameEntries = performance.getEntriesByName(request.url, 'resource');\n\n  if (!sameNameEntries.length || !('toJSON' in sameNameEntries[0])) {\n    return;\n  }\n\n  var candidates = sameNameEntries.map(function (entry) {\n    return entry.toJSON();\n  }).filter(toValidEntry).filter(function (entry) {\n    return isBetween(entry, request.startTime, endTime(request));\n  });\n\n  if (candidates.length === 1) {\n    return candidates[0];\n  }\n\n  if (candidates.length === 2 && firstCanBeOptionRequest(candidates)) {\n    return candidates[1];\n  }\n\n  return;\n}\n\nfunction firstCanBeOptionRequest(correspondingEntries) {\n  return endTime(correspondingEntries[0]) <= correspondingEntries[1].startTime;\n}\n\nfunction endTime(timing) {\n  // eslint-disable-next-line @typescript-eslint/restrict-plus-operands\n  return timing.startTime + timing.duration;\n}\n\nfunction isBetween(timing, start, end) {\n  return timing.startTime >= start && endTime(timing) <= end;\n}","import { __assign } from \"tslib\";\nimport { combine, generateUUID, getTimeStamp, RequestType, ResourceType, toServerDuration } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { matchRequestTiming } from './matchRequestTiming';\nimport { computePerformanceResourceDetails, computePerformanceResourceDuration, computeResourceKind, computeSize, isRequestKind } from './resourceUtils';\nexport function startResourceCollection(lifeCycle, session) {\n  lifeCycle.subscribe(LifeCycleEventType.REQUEST_COMPLETED, function (request) {\n    if (session.isTrackedWithResource()) {\n      lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processRequest(request));\n    }\n  });\n  lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (session.isTrackedWithResource() && entry.entryType === 'resource' && !isRequestKind(entry)) {\n      lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processResourceEntry(entry));\n    }\n  });\n}\n\nfunction processRequest(request) {\n  var type = request.type === RequestType.XHR ? ResourceType.XHR : ResourceType.FETCH;\n  var matchingTiming = matchRequestTiming(request);\n  var startTime = matchingTiming ? matchingTiming.startTime : request.startTime;\n  var correspondingTimingOverrides = matchingTiming ? computePerformanceEntryMetrics(matchingTiming) : undefined;\n  var tracingInfo = computeRequestTracingInfo(request);\n  var resourceEvent = combine({\n    date: getTimeStamp(startTime),\n    resource: {\n      type: type,\n      duration: toServerDuration(request.duration),\n      method: request.method,\n      status_code: request.status,\n      url: request.url\n    },\n    type: RumEventType.RESOURCE\n  }, tracingInfo, correspondingTimingOverrides);\n  return {\n    startTime: startTime,\n    rawRumEvent: resourceEvent\n  };\n}\n\nfunction processResourceEntry(entry) {\n  var type = computeResourceKind(entry);\n  var entryMetrics = computePerformanceEntryMetrics(entry);\n  var tracingInfo = computeEntryTracingInfo(entry);\n  var resourceEvent = combine({\n    date: getTimeStamp(entry.startTime),\n    resource: {\n      type: type,\n      url: entry.name\n    },\n    type: RumEventType.RESOURCE\n  }, tracingInfo, entryMetrics);\n  return {\n    startTime: entry.startTime,\n    rawRumEvent: resourceEvent\n  };\n}\n\nfunction computePerformanceEntryMetrics(timing) {\n  return {\n    resource: __assign({\n      duration: computePerformanceResourceDuration(timing),\n      size: computeSize(timing)\n    }, computePerformanceResourceDetails(timing))\n  };\n}\n\nfunction computeRequestTracingInfo(request) {\n  var hasBeenTraced = request.traceId && request.spanId;\n\n  if (!hasBeenTraced) {\n    return undefined;\n  }\n\n  return {\n    _dd: {\n      span_id: request.spanId.toDecimalString(),\n      trace_id: request.traceId.toDecimalString()\n    },\n    resource: {\n      id: generateUUID()\n    }\n  };\n}\n\nfunction computeEntryTracingInfo(entry) {\n  return entry.traceId ? {\n    _dd: {\n      trace_id: entry.traceId\n    }\n  } : undefined;\n}","import { __assign } from \"tslib\";\nimport { addEventListeners, addMonitoringMessage, elapsed } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackFirstHidden } from './trackFirstHidden';\nexport function trackTimings(lifeCycle, callback) {\n  var timings;\n\n  function setTimings(newTimings) {\n    timings = __assign(__assign({}, timings), newTimings);\n    callback(timings);\n  }\n\n  var stopNavigationTracking = trackNavigationTimings(lifeCycle, setTimings).stop;\n  var stopFCPTracking = trackFirstContentfulPaint(lifeCycle, function (firstContentfulPaint) {\n    return setTimings({\n      firstContentfulPaint: firstContentfulPaint\n    });\n  }).stop;\n  var stopLCPTracking = trackLargestContentfulPaint(lifeCycle, window, function (largestContentfulPaint) {\n    setTimings({\n      largestContentfulPaint: largestContentfulPaint\n    });\n  }).stop;\n  var stopFIDTracking = trackFirstInputTimings(lifeCycle, function (_a) {\n    var firstInputDelay = _a.firstInputDelay,\n        firstInputTime = _a.firstInputTime;\n    setTimings({\n      firstInputDelay: firstInputDelay,\n      firstInputTime: firstInputTime\n    });\n  }).stop;\n  return {\n    stop: function stop() {\n      stopNavigationTracking();\n      stopFCPTracking();\n      stopLCPTracking();\n      stopFIDTracking();\n    }\n  };\n}\nexport function trackNavigationTimings(lifeCycle, callback) {\n  var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType === 'navigation') {\n      callback({\n        domComplete: entry.domComplete,\n        domContentLoaded: entry.domContentLoadedEventEnd,\n        domInteractive: entry.domInteractive,\n        loadEvent: entry.loadEventEnd\n      });\n    }\n  }).unsubscribe;\n  return {\n    stop: stop\n  };\n}\nexport function trackFirstContentfulPaint(lifeCycle, callback) {\n  var firstHidden = trackFirstHidden();\n  var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType === 'paint' && entry.name === 'first-contentful-paint' && entry.startTime < firstHidden.timeStamp) {\n      callback(entry.startTime);\n    }\n  }).unsubscribe;\n  return {\n    stop: stop\n  };\n}\n/**\n * Track the largest contentful paint (LCP) occurring during the initial View.  This can yield\n * multiple values, only the most recent one should be used.\n * Documentation: https://web.dev/lcp/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getLCP.ts\n */\n\nexport function trackLargestContentfulPaint(lifeCycle, emitter, callback) {\n  var firstHidden = trackFirstHidden(); // Ignore entries that come after the first user interaction.  According to the documentation, the\n  // browser should not send largest-contentful-paint entries after a user interact with the page,\n  // but the web-vitals reference implementation uses this as a safeguard.\n\n  var firstInteractionTimestamp = Infinity;\n  var stopEventListener = addEventListeners(emitter, [\"pointerdown\"\n  /* POINTER_DOWN */\n  , \"keydown\"\n  /* KEY_DOWN */\n  ], function (event) {\n    firstInteractionTimestamp = event.timeStamp;\n  }, {\n    capture: true,\n    once: true\n  }).stop;\n  var unsubscribeLifeCycle = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType === 'largest-contentful-paint' && entry.startTime < firstInteractionTimestamp && entry.startTime < firstHidden.timeStamp) {\n      callback(entry.startTime);\n    }\n  }).unsubscribe;\n  return {\n    stop: function stop() {\n      stopEventListener();\n      unsubscribeLifeCycle();\n    }\n  };\n}\n/**\n * Track the first input occurring during the initial View to return:\n * - First Input Delay\n * - First Input Time\n * Callback is called at most one time.\n * Documentation: https://web.dev/fid/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getFID.ts\n */\n\nexport function trackFirstInputTimings(lifeCycle, callback) {\n  var firstHidden = trackFirstHidden();\n  var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType === 'first-input' && entry.startTime < firstHidden.timeStamp) {\n      // Discard invalid first-input entries, see\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=1185815\n      if (entry.startTime <= entry.processingStart) {\n        callback({\n          firstInputDelay: elapsed(entry.startTime, entry.processingStart),\n          firstInputTime: entry.startTime\n        });\n      } else if (entry.toJSON) {\n        addMonitoringMessage(\"Negative FID for entry \" + entry.name, {\n          entry: __assign(__assign({}, entry.toJSON()), {\n            target: undefined\n          }),\n          fid: entry.processingStart - entry.startTime\n        });\n      }\n    }\n  }).unsubscribe;\n  return {\n    stop: stop\n  };\n}","import { __assign } from \"tslib\";\nimport { addEventListener, elapsed, generateUUID, monitor, noop, ONE_MINUTE, relativeNow, throttle } from '@datadog/browser-core';\nimport { supportPerformanceTimingEvent } from '../../../browser/performanceCollection';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackEventCounts } from '../../trackEventCounts';\nimport { waitIdlePageActivity } from '../../trackPageActivities';\nimport { ViewLoadingType } from '../../../rawRumEvent.types';\nimport { trackTimings } from './trackTimings';\nexport var THROTTLE_VIEW_UPDATE_PERIOD = 3000;\nexport var SESSION_KEEP_ALIVE_INTERVAL = 5 * ONE_MINUTE;\nexport function trackViews(location, lifeCycle, onNewLocation) {\n  var _a;\n\n  if (onNewLocation === void 0) {\n    onNewLocation = function onNewLocation() {\n      return undefined;\n    };\n  }\n\n  var startOrigin = 0;\n  var initialView = newView(lifeCycle, location, ViewLoadingType.INITIAL_LOAD, document.referrer, startOrigin, (_a = onNewLocation(location)) === null || _a === void 0 ? void 0 : _a.viewName);\n  var currentView = initialView;\n  var stopTimingsTracking = trackTimings(lifeCycle, function (timings) {\n    initialView.updateTimings(timings);\n    initialView.scheduleUpdate();\n  }).stop;\n  var stopHistoryTracking = trackHistory(onLocationChange).stop;\n  var stopHashTracking = trackHash(onLocationChange).stop;\n\n  function onLocationChange() {\n    var _a = onNewLocation(location, currentView.getLocation()) || {},\n        viewName = _a.viewName,\n        shouldCreateView = _a.shouldCreateView;\n\n    if (shouldCreateView || shouldCreateView === undefined && currentView.isDifferentView(location)) {\n      // Renew view on location changes\n      currentView.end();\n      currentView.triggerUpdate();\n      currentView = newView(lifeCycle, location, ViewLoadingType.ROUTE_CHANGE, currentView.url, undefined, viewName);\n      return;\n    }\n\n    currentView.updateLocation(location);\n    currentView.triggerUpdate();\n  } // Renew view on session renewal\n\n\n  lifeCycle.subscribe(LifeCycleEventType.SESSION_RENEWED, function () {\n    // do not trigger view update to avoid wrong data\n    currentView.end();\n    currentView = newView(lifeCycle, location, ViewLoadingType.ROUTE_CHANGE, currentView.url);\n  }); // End the current view on page unload\n\n  lifeCycle.subscribe(LifeCycleEventType.BEFORE_UNLOAD, function () {\n    currentView.end();\n    currentView.triggerUpdate();\n  }); // Session keep alive\n\n  var keepAliveInterval = window.setInterval(monitor(function () {\n    currentView.triggerUpdate();\n  }), SESSION_KEEP_ALIVE_INTERVAL);\n  return {\n    addTiming: function addTiming(name, time) {\n      if (time === void 0) {\n        time = relativeNow();\n      }\n\n      currentView.addTiming(name, time);\n      currentView.triggerUpdate();\n    },\n    stop: function stop() {\n      stopHistoryTracking();\n      stopHashTracking();\n      stopTimingsTracking();\n      currentView.end();\n      clearInterval(keepAliveInterval);\n    }\n  };\n}\n\nfunction newView(lifeCycle, initialLocation, loadingType, referrer, startTime, name) {\n  if (startTime === void 0) {\n    startTime = relativeNow();\n  } // Setup initial values\n\n\n  var id = generateUUID();\n  var eventCounts = {\n    errorCount: 0,\n    longTaskCount: 0,\n    resourceCount: 0,\n    userActionCount: 0\n  };\n  var timings = {};\n  var customTimings = {};\n  var documentVersion = 0;\n  var cumulativeLayoutShift;\n  var loadingTime;\n  var endTime;\n\n  var location = __assign({}, initialLocation);\n\n  lifeCycle.notify(LifeCycleEventType.VIEW_CREATED, {\n    id: id,\n    startTime: startTime,\n    location: location,\n    referrer: referrer\n  }); // Update the view every time the measures are changing\n\n  var _a = throttle(monitor(triggerViewUpdate), THROTTLE_VIEW_UPDATE_PERIOD, {\n    leading: false\n  }),\n      scheduleViewUpdate = _a.throttled,\n      cancelScheduleViewUpdate = _a.cancel;\n\n  var stopEventCountsTracking = trackEventCounts(lifeCycle, function (newEventCounts) {\n    eventCounts = newEventCounts;\n    scheduleViewUpdate();\n  }).stop;\n\n  var _b = trackLoadingTime(loadingType, function (newLoadingTime) {\n    loadingTime = newLoadingTime;\n    scheduleViewUpdate();\n  }),\n      setActivityLoadingTime = _b.setActivityLoadingTime,\n      setLoadEvent = _b.setLoadEvent;\n\n  var stopActivityLoadingTimeTracking = trackActivityLoadingTime(lifeCycle, setActivityLoadingTime).stop;\n  var stopCLSTracking;\n\n  if (isLayoutShiftSupported()) {\n    cumulativeLayoutShift = 0;\n    stopCLSTracking = trackLayoutShift(lifeCycle, function (layoutShift) {\n      cumulativeLayoutShift += layoutShift;\n      scheduleViewUpdate();\n    }).stop;\n  } else {\n    stopCLSTracking = noop;\n  } // Initial view update\n\n\n  triggerViewUpdate();\n\n  function triggerViewUpdate() {\n    documentVersion += 1;\n    lifeCycle.notify(LifeCycleEventType.VIEW_UPDATED, {\n      cumulativeLayoutShift: cumulativeLayoutShift,\n      customTimings: customTimings,\n      documentVersion: documentVersion,\n      eventCounts: eventCounts,\n      id: id,\n      name: name,\n      loadingTime: loadingTime,\n      loadingType: loadingType,\n      location: location,\n      referrer: referrer,\n      startTime: startTime,\n      timings: timings,\n      duration: elapsed(startTime, endTime === undefined ? relativeNow() : endTime),\n      isActive: endTime === undefined\n    });\n  }\n\n  return {\n    scheduleUpdate: scheduleViewUpdate,\n    end: function end() {\n      endTime = relativeNow();\n      stopEventCountsTracking();\n      stopActivityLoadingTimeTracking();\n      stopCLSTracking();\n      lifeCycle.notify(LifeCycleEventType.VIEW_ENDED);\n    },\n    isDifferentView: function isDifferentView(otherLocation) {\n      return location.pathname !== otherLocation.pathname || !isHashAnAnchor(otherLocation.hash) && otherLocation.hash !== location.hash;\n    },\n    getLocation: function getLocation() {\n      return location;\n    },\n    triggerUpdate: function triggerUpdate() {\n      // cancel any pending view updates execution\n      cancelScheduleViewUpdate();\n      triggerViewUpdate();\n    },\n    updateTimings: function updateTimings(newTimings) {\n      timings = newTimings;\n\n      if (newTimings.loadEvent !== undefined) {\n        setLoadEvent(newTimings.loadEvent);\n      }\n    },\n    addTiming: function addTiming(name, endTime) {\n      customTimings[sanitizeTiming(name)] = elapsed(startTime, endTime);\n    },\n    updateLocation: function updateLocation(newLocation) {\n      location = __assign({}, newLocation);\n    },\n\n    get url() {\n      return location.href;\n    }\n\n  };\n}\n\nfunction isHashAnAnchor(hash) {\n  var correspondingId = hash.substr(1);\n  return !!document.getElementById(correspondingId);\n}\n\nfunction trackHistory(onHistoryChange) {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  var originalPushState = history.pushState;\n  history.pushState = monitor(function () {\n    originalPushState.apply(this, arguments);\n    onHistoryChange();\n  }); // eslint-disable-next-line @typescript-eslint/unbound-method\n\n  var originalReplaceState = history.replaceState;\n  history.replaceState = monitor(function () {\n    originalReplaceState.apply(this, arguments);\n    onHistoryChange();\n  });\n  var removeListener = addEventListener(window, \"popstate\"\n  /* POP_STATE */\n  , onHistoryChange).stop;\n\n  var stop = function stop() {\n    removeListener();\n    history.pushState = originalPushState;\n    history.replaceState = originalReplaceState;\n  };\n\n  return {\n    stop: stop\n  };\n}\n\nfunction trackHash(onHashChange) {\n  return addEventListener(window, \"hashchange\"\n  /* HASH_CHANGE */\n  , onHashChange);\n}\n\nfunction trackLoadingTime(loadType, callback) {\n  var isWaitingForLoadEvent = loadType === ViewLoadingType.INITIAL_LOAD;\n  var isWaitingForActivityLoadingTime = true;\n  var loadingTimeCandidates = [];\n\n  function invokeCallbackIfAllCandidatesAreReceived() {\n    if (!isWaitingForActivityLoadingTime && !isWaitingForLoadEvent && loadingTimeCandidates.length > 0) {\n      callback(Math.max.apply(Math, loadingTimeCandidates));\n    }\n  }\n\n  return {\n    setLoadEvent: function setLoadEvent(loadEvent) {\n      if (isWaitingForLoadEvent) {\n        isWaitingForLoadEvent = false;\n        loadingTimeCandidates.push(loadEvent);\n        invokeCallbackIfAllCandidatesAreReceived();\n      }\n    },\n    setActivityLoadingTime: function setActivityLoadingTime(activityLoadingTime) {\n      if (isWaitingForActivityLoadingTime) {\n        isWaitingForActivityLoadingTime = false;\n\n        if (activityLoadingTime !== undefined) {\n          loadingTimeCandidates.push(activityLoadingTime);\n        }\n\n        invokeCallbackIfAllCandidatesAreReceived();\n      }\n    }\n  };\n}\n\nfunction trackActivityLoadingTime(lifeCycle, callback) {\n  var startTime = relativeNow();\n  var stopWaitIdlePageActivity = waitIdlePageActivity(lifeCycle, function (hadActivity, endTime) {\n    if (hadActivity) {\n      callback(elapsed(startTime, endTime));\n    } else {\n      callback(undefined);\n    }\n  }).stop;\n  return {\n    stop: stopWaitIdlePageActivity\n  };\n}\n/**\n * Track layout shifts (LS) occurring during the Views.  This yields multiple values that can be\n * added up to compute the cumulated layout shift (CLS).\n *\n * See isLayoutShiftSupported to check for browser support.\n *\n * Documentation: https://web.dev/cls/\n * Reference implementation: https://github.com/GoogleChrome/web-vitals/blob/master/src/getCLS.ts\n */\n\n\nfunction trackLayoutShift(lifeCycle, callback) {\n  var stop = lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType === 'layout-shift' && !entry.hadRecentInput) {\n      callback(entry.value);\n    }\n  }).unsubscribe;\n  return {\n    stop: stop\n  };\n}\n/**\n * Check whether `layout-shift` is supported by the browser.\n */\n\n\nfunction isLayoutShiftSupported() {\n  return supportPerformanceTimingEvent('layout-shift');\n}\n/**\n * Timing name is used as facet path that must contain only letters, digits, or the characters - _ . @ $\n */\n\n\nfunction sanitizeTiming(name) {\n  var sanitized = name.replace(/[^a-zA-Z0-9-_.@$]/g, '_');\n\n  if (sanitized !== name) {\n    console.warn(\"Invalid timing name: \" + name + \", sanitized to: \" + sanitized);\n  }\n\n  return sanitized;\n}","import { getTimeStamp, isEmptyObject, mapValues, toServerDuration } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nimport { trackViews } from './trackViews';\nexport function startViewCollection(lifeCycle, location, onNewLocation) {\n  lifeCycle.subscribe(LifeCycleEventType.VIEW_UPDATED, function (view) {\n    return lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, processViewUpdate(view));\n  });\n  return trackViews(location, lifeCycle, onNewLocation);\n}\n\nfunction processViewUpdate(view) {\n  var viewEvent = {\n    _dd: {\n      document_version: view.documentVersion\n    },\n    date: getTimeStamp(view.startTime),\n    type: RumEventType.VIEW,\n    view: {\n      action: {\n        count: view.eventCounts.userActionCount\n      },\n      cumulative_layout_shift: view.cumulativeLayoutShift,\n      dom_complete: toServerDuration(view.timings.domComplete),\n      dom_content_loaded: toServerDuration(view.timings.domContentLoaded),\n      dom_interactive: toServerDuration(view.timings.domInteractive),\n      error: {\n        count: view.eventCounts.errorCount\n      },\n      first_contentful_paint: toServerDuration(view.timings.firstContentfulPaint),\n      first_input_delay: toServerDuration(view.timings.firstInputDelay),\n      first_input_time: toServerDuration(view.timings.firstInputTime),\n      is_active: view.isActive,\n      name: view.name,\n      largest_contentful_paint: toServerDuration(view.timings.largestContentfulPaint),\n      load_event: toServerDuration(view.timings.loadEvent),\n      loading_time: toServerDuration(view.loadingTime),\n      loading_type: view.loadingType,\n      long_task: {\n        count: view.eventCounts.longTaskCount\n      },\n      resource: {\n        count: view.eventCounts.resourceCount\n      },\n      time_spent: toServerDuration(view.duration)\n    }\n  };\n\n  if (!isEmptyObject(view.customTimings)) {\n    viewEvent.view.custom_timings = mapValues(view.customTimings, toServerDuration);\n  }\n\n  return {\n    rawRumEvent: viewEvent,\n    startTime: view.startTime\n  };\n}","import { performDraw, startSessionManagement } from '@datadog/browser-core';\nimport { LifeCycleEventType } from './lifeCycle';\nexport var RUM_SESSION_KEY = 'rum';\nexport var RumTrackingType;\n\n(function (RumTrackingType) {\n  RumTrackingType[\"NOT_TRACKED\"] = \"0\";\n  RumTrackingType[\"TRACKED_WITH_RESOURCES\"] = \"1\";\n  RumTrackingType[\"TRACKED_WITHOUT_RESOURCES\"] = \"2\";\n})(RumTrackingType || (RumTrackingType = {}));\n\nexport function startRumSession(configuration, lifeCycle) {\n  var session = startSessionManagement(configuration.cookieOptions, RUM_SESSION_KEY, function (rawTrackingType) {\n    return computeSessionState(configuration, rawTrackingType);\n  });\n  session.renewObservable.subscribe(function () {\n    lifeCycle.notify(LifeCycleEventType.SESSION_RENEWED);\n  });\n  return {\n    getId: session.getId,\n    isTracked: function isTracked() {\n      return session.getId() !== undefined && _isTracked(session.getTrackingType());\n    },\n    isTrackedWithResource: function isTrackedWithResource() {\n      return session.getId() !== undefined && session.getTrackingType() === RumTrackingType.TRACKED_WITH_RESOURCES;\n    }\n  };\n}\n\nfunction computeSessionState(configuration, rawTrackingType) {\n  var trackingType;\n\n  if (hasValidRumSession(rawTrackingType)) {\n    trackingType = rawTrackingType;\n  } else if (!performDraw(configuration.sampleRate)) {\n    trackingType = RumTrackingType.NOT_TRACKED;\n  } else if (!performDraw(configuration.resourceSampleRate)) {\n    trackingType = RumTrackingType.TRACKED_WITHOUT_RESOURCES;\n  } else {\n    trackingType = RumTrackingType.TRACKED_WITH_RESOURCES;\n  }\n\n  return {\n    trackingType: trackingType,\n    isTracked: _isTracked(trackingType)\n  };\n}\n\nfunction hasValidRumSession(trackingType) {\n  return trackingType === RumTrackingType.NOT_TRACKED || trackingType === RumTrackingType.TRACKED_WITH_RESOURCES || trackingType === RumTrackingType.TRACKED_WITHOUT_RESOURCES;\n}\n\nfunction _isTracked(rumSessionType) {\n  return rumSessionType === RumTrackingType.TRACKED_WITH_RESOURCES || rumSessionType === RumTrackingType.TRACKED_WITHOUT_RESOURCES;\n}","import { Batch, combine, HttpRequest } from '@datadog/browser-core';\nimport { LifeCycleEventType } from '../domain/lifeCycle';\nimport { RumEventType } from '../rawRumEvent.types';\nexport function startRumBatch(configuration, lifeCycle) {\n  var batch = makeRumBatch(configuration, lifeCycle);\n  lifeCycle.subscribe(LifeCycleEventType.RUM_EVENT_COLLECTED, function (serverRumEvent) {\n    if (serverRumEvent.type === RumEventType.VIEW) {\n      batch.upsert(serverRumEvent, serverRumEvent.view.id);\n    } else {\n      batch.add(serverRumEvent);\n    }\n  });\n  return {\n    stop: function stop() {\n      batch.stop();\n    }\n  };\n}\n\nfunction makeRumBatch(configuration, lifeCycle) {\n  var primaryBatch = createRumBatch(configuration.rumEndpoint, function () {\n    return lifeCycle.notify(LifeCycleEventType.BEFORE_UNLOAD);\n  });\n  var replicaBatch;\n  var replica = configuration.replica;\n\n  if (replica !== undefined) {\n    replicaBatch = createRumBatch(replica.rumEndpoint);\n  }\n\n  function createRumBatch(endpointUrl, unloadCallback) {\n    return new Batch(new HttpRequest(endpointUrl, configuration.batchBytesLimit, true), configuration.maxBatchSize, configuration.batchBytesLimit, configuration.maxMessageSize, configuration.flushTimeout, unloadCallback);\n  }\n\n  function withReplicaApplicationId(message) {\n    return combine(message, {\n      application: {\n        id: replica.applicationId\n      }\n    });\n  }\n\n  var stopped = false;\n  return {\n    add: function add(message) {\n      if (stopped) {\n        return;\n      }\n\n      primaryBatch.add(message);\n\n      if (replicaBatch) {\n        replicaBatch.add(withReplicaApplicationId(message));\n      }\n    },\n    stop: function stop() {\n      stopped = true;\n    },\n    upsert: function upsert(message, key) {\n      if (stopped) {\n        return;\n      }\n\n      primaryBatch.upsert(message, key);\n\n      if (replicaBatch) {\n        replicaBatch.upsert(withReplicaApplicationId(message), key);\n      }\n    }\n  };\n}","export var buildEnv = {\n  buildMode: 'release',\n  datacenter: 'us',\n  sdkVersion: '2.6.2'\n};","import { defineGlobal, getGlobalObject } from '@datadog/browser-core';\nimport { makeRumPublicApi, startRum } from '@datadog/browser-rum-core';\nexport var datadogRum = makeRumPublicApi(startRum);\ndefineGlobal(getGlobalObject(), 'DD_RUM', datadogRum);","import { BoundedBuffer, buildCookieOptions, checkCookiesAuthorized, checkIsNotLocalFile, createContextManager, deepClone, ErrorSource, isPercentage, makePublicApi, monitor, relativeNow } from '@datadog/browser-core';\nimport { ActionType } from '../rawRumEvent.types';\nexport function makeRumPublicApi(startRumImpl) {\n  var isAlreadyInitialized = false;\n  var globalContextManager = createContextManager();\n  var user = {};\n\n  var getInternalContextStrategy = function getInternalContextStrategy() {\n    return undefined;\n  };\n\n  var beforeInitAddTiming = new BoundedBuffer();\n\n  var addTimingStrategy = function addTimingStrategy(name) {\n    beforeInitAddTiming.add([name, relativeNow()]);\n  };\n\n  var beforeInitAddAction = new BoundedBuffer();\n\n  var addActionStrategy = function addActionStrategy(action) {\n    beforeInitAddAction.add([action, clonedCommonContext()]);\n  };\n\n  var beforeInitAddError = new BoundedBuffer();\n\n  var addErrorStrategy = function addErrorStrategy(providedError) {\n    beforeInitAddError.add([providedError, clonedCommonContext()]);\n  };\n\n  function clonedCommonContext() {\n    return deepClone({\n      context: globalContextManager.get(),\n      user: user\n    });\n  }\n\n  var rumGlobal = makePublicApi({\n    init: monitor(function (userConfiguration) {\n      var _a;\n\n      if (!checkCookiesAuthorized(buildCookieOptions(userConfiguration)) || !checkIsNotLocalFile() || !canInitRum(userConfiguration)) {\n        return;\n      }\n\n      if (userConfiguration.publicApiKey) {\n        userConfiguration.clientToken = userConfiguration.publicApiKey;\n      }\n\n      ;\n      _a = startRumImpl(userConfiguration, function () {\n        return {\n          user: user,\n          context: globalContextManager.get()\n        };\n      }), addActionStrategy = _a.addAction, addErrorStrategy = _a.addError, addTimingStrategy = _a.addTiming, getInternalContextStrategy = _a.getInternalContext;\n      beforeInitAddAction.drain(function (_a) {\n        var action = _a[0],\n            commonContext = _a[1];\n        return addActionStrategy(action, commonContext);\n      });\n      beforeInitAddError.drain(function (_a) {\n        var error = _a[0],\n            commonContext = _a[1];\n        return addErrorStrategy(error, commonContext);\n      });\n      beforeInitAddTiming.drain(function (_a) {\n        var name = _a[0],\n            time = _a[1];\n        return addTimingStrategy(name, time);\n      });\n      isAlreadyInitialized = true;\n    }),\n    addRumGlobalContext: monitor(globalContextManager.add),\n    removeRumGlobalContext: monitor(globalContextManager.remove),\n    getRumGlobalContext: monitor(globalContextManager.get),\n    setRumGlobalContext: monitor(globalContextManager.set),\n    getInternalContext: monitor(function (startTime) {\n      return getInternalContextStrategy(startTime);\n    }),\n    addAction: monitor(function (name, context) {\n      addActionStrategy({\n        name: name,\n        context: deepClone(context),\n        startTime: relativeNow(),\n        type: ActionType.CUSTOM\n      });\n    }),\n\n    /**\n     * @deprecated use addAction instead\n     */\n    addUserAction: function addUserAction(name, context) {\n      rumGlobal.addAction(name, context);\n    },\n    addError: monitor(function (error, context, source) {\n      if (source === void 0) {\n        source = ErrorSource.CUSTOM;\n      }\n\n      var checkedSource;\n\n      if (source === ErrorSource.CUSTOM || source === ErrorSource.NETWORK || source === ErrorSource.SOURCE) {\n        checkedSource = source;\n      } else {\n        console.error(\"DD_RUM.addError: Invalid source '\" + source + \"'\");\n        checkedSource = ErrorSource.CUSTOM;\n      }\n\n      addErrorStrategy({\n        error: error,\n        context: deepClone(context),\n        source: checkedSource,\n        startTime: relativeNow()\n      });\n    }),\n    addTiming: monitor(function (name) {\n      addTimingStrategy(name);\n    }),\n    setUser: monitor(function (newUser) {\n      var sanitizedUser = sanitizeUser(newUser);\n\n      if (sanitizedUser) {\n        user = sanitizedUser;\n      } else {\n        console.error('Unsupported user:', newUser);\n      }\n    })\n  });\n  return rumGlobal;\n\n  function sanitizeUser(newUser) {\n    if (typeof newUser !== 'object' || !newUser) {\n      return;\n    }\n\n    var result = deepClone(newUser);\n\n    if ('id' in result) {\n      result.id = String(result.id);\n    }\n\n    if ('name' in result) {\n      result.name = String(result.name);\n    }\n\n    if ('email' in result) {\n      result.email = String(result.email);\n    }\n\n    return result;\n  }\n\n  function canInitRum(userConfiguration) {\n    if (isAlreadyInitialized) {\n      if (!userConfiguration.silentMultipleInit) {\n        console.error('DD_RUM is already initialized.');\n      }\n\n      return false;\n    }\n\n    if (!userConfiguration || !userConfiguration.clientToken && !userConfiguration.publicApiKey) {\n      console.error('Client Token is not configured, we will not send any data.');\n      return false;\n    }\n\n    if (!userConfiguration.applicationId) {\n      console.error('Application ID is not configured, no RUM data will be collected.');\n      return false;\n    }\n\n    if (userConfiguration.sampleRate !== undefined && !isPercentage(userConfiguration.sampleRate)) {\n      console.error('Sample Rate should be a number between 0 and 100');\n      return false;\n    }\n\n    if (userConfiguration.resourceSampleRate !== undefined && !isPercentage(userConfiguration.resourceSampleRate)) {\n      console.error('Resource Sample Rate should be a number between 0 and 100');\n      return false;\n    }\n\n    if (Array.isArray(userConfiguration.allowedTracingOrigins) && userConfiguration.allowedTracingOrigins.length !== 0 && userConfiguration.service === undefined) {\n      console.error('Service need to be configured when tracing is enabled');\n      return false;\n    }\n\n    return true;\n  }\n}","import { catchUserErrors, combine, commonInit } from '@datadog/browser-core';\nimport { startDOMMutationCollection } from '../browser/domMutationCollection';\nimport { startPerformanceCollection } from '../browser/performanceCollection';\nimport { startRumAssembly } from '../domain/assembly';\nimport { startInternalContext } from '../domain/internalContext';\nimport { LifeCycle } from '../domain/lifeCycle';\nimport { startParentContexts } from '../domain/parentContexts';\nimport { startRequestCollection } from '../domain/requestCollection';\nimport { startActionCollection } from '../domain/rumEventsCollection/action/actionCollection';\nimport { startErrorCollection } from '../domain/rumEventsCollection/error/errorCollection';\nimport { startLongTaskCollection } from '../domain/rumEventsCollection/longTask/longTaskCollection';\nimport { startResourceCollection } from '../domain/rumEventsCollection/resource/resourceCollection';\nimport { startViewCollection } from '../domain/rumEventsCollection/view/viewCollection';\nimport { startRumSession } from '../domain/rumSession';\nimport { startRumBatch } from '../transport/batch';\nimport { buildEnv } from './buildEnv';\nexport function startRum(userConfiguration, getCommonContext) {\n  var lifeCycle = new LifeCycle();\n\n  var _a = commonInit(userConfiguration, buildEnv),\n      configuration = _a.configuration,\n      internalMonitoring = _a.internalMonitoring;\n\n  var session = startRumSession(configuration, lifeCycle);\n\n  if (!configuration.isEnabled('onNewLocation')) {\n    userConfiguration.onNewLocation = undefined;\n  }\n\n  internalMonitoring.setExternalContextProvider(function () {\n    return combine({\n      application_id: userConfiguration.applicationId\n    }, parentContexts.findView(), getCommonContext().context);\n  });\n\n  var _b = startRumEventCollection(userConfiguration.applicationId, location, lifeCycle, configuration, session, getCommonContext, userConfiguration.onNewLocation),\n      parentContexts = _b.parentContexts,\n      addError = _b.addError,\n      addAction = _b.addAction,\n      addTiming = _b.addTiming;\n\n  startRequestCollection(lifeCycle, configuration);\n  startPerformanceCollection(lifeCycle, configuration);\n  startDOMMutationCollection(lifeCycle);\n  var internalContext = startInternalContext(userConfiguration.applicationId, session, parentContexts);\n  return {\n    addAction: addAction,\n    addError: addError,\n    addTiming: addTiming,\n    configuration: configuration,\n    lifeCycle: lifeCycle,\n    parentContexts: parentContexts,\n    session: session,\n    getInternalContext: internalContext.get\n  };\n}\nexport function startRumEventCollection(applicationId, location, lifeCycle, configuration, session, getCommonContext, onNewLocation) {\n  var parentContexts = startParentContexts(lifeCycle, session);\n  var batch = startRumBatch(configuration, lifeCycle);\n  startRumAssembly(applicationId, configuration, lifeCycle, session, parentContexts, getCommonContext);\n  startLongTaskCollection(lifeCycle);\n  startResourceCollection(lifeCycle, session);\n\n  var _a = startViewCollection(lifeCycle, location, onNewLocation && catchUserErrors(onNewLocation, 'onNewLocation threw an error:')),\n      addTiming = _a.addTiming,\n      stopViewCollection = _a.stop;\n\n  var addError = startErrorCollection(lifeCycle, configuration).addError;\n  var addAction = startActionCollection(lifeCycle, configuration).addAction;\n  return {\n    addAction: addAction,\n    addError: addError,\n    parentContexts: parentContexts,\n    addTiming: addTiming,\n    stop: function stop() {\n      stopViewCollection(); // prevent batch from previous tests to keep running and send unwanted requests\n      // could be replaced by stopping all the component when they will all have a stop method\n\n      batch.stop();\n    }\n  };\n}","import { getTimeStamp, toServerDuration } from '@datadog/browser-core';\nimport { RumEventType } from '../../../rawRumEvent.types';\nimport { LifeCycleEventType } from '../../lifeCycle';\nexport function startLongTaskCollection(lifeCycle) {\n  lifeCycle.subscribe(LifeCycleEventType.PERFORMANCE_ENTRY_COLLECTED, function (entry) {\n    if (entry.entryType !== 'longtask') {\n      return;\n    }\n\n    var rawRumEvent = {\n      date: getTimeStamp(entry.startTime),\n      long_task: {\n        duration: toServerDuration(entry.duration)\n      },\n      type: RumEventType.LONG_TASK\n    };\n    lifeCycle.notify(LifeCycleEventType.RAW_RUM_EVENT_COLLECTED, {\n      rawRumEvent: rawRumEvent,\n      startTime: entry.startTime\n    });\n  });\n}","/**\n * Internal context keep returning v1 format\n * to not break compatibility with logs data format\n */\nexport function startInternalContext(applicationId, session, parentContexts) {\n  return {\n    get: function get(startTime) {\n      var viewContext = parentContexts.findView(startTime);\n\n      if (session.isTracked() && viewContext && viewContext.session.id) {\n        var actionContext = parentContexts.findAction(startTime);\n        return {\n          application_id: applicationId,\n          session_id: viewContext.session.id,\n          user_action: actionContext ? {\n            id: actionContext.action.id\n          } : undefined,\n          view: viewContext.view\n        };\n      }\n    }\n  };\n}"],"sourceRoot":""}